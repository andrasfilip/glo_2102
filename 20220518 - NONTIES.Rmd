---
title: "20220518 - NONTIES"
author: "Filip Andras"
date: "5/18/2022"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


```{r}
library(tidyverse)
library(MASS)
library(naniar)
library(gridExtra)
library(lme4)
library(afex)
library(lattice)
library(ggeffects)
library(harrypotter)
library(knitr)
library(kableExtra)
library(jtools)
library(gridExtra)
library(ggpubr)
library(broom.mixed)
library(sjPlot)
```

```{r}
sessionInfo()
options(scipen = 999)
getwd()
# setwd("/Users/Filip/Desktop/PhD 2020/__20210227 - Gloria/glo_2102/glo_2102")
```

```{r}
d.outliers_without <- read_csv("d_outliers_without.csv") 
#para crear esto es hasta la línea 527 en el otro documento
#16138 data líneas
```

# análisis por separado --------------------------------------------------------

# Very-small non-ties ----------------------------------------------------------
```{r}
d <- d.outliers_without %>% 
  filter(n.tie_very_small == 1)                                                 # CHANGE IT HERE

d$sum.f.n <- scale(as.numeric(d$sum.f))
hist(d$sum.f.n, breaks = 20)

xtabs(~ sum.f + group.cod, data = d)

# Alternative predictors -------------------------------------------------------

d$pre.min.n            <- scale(as.numeric(d$pre.min)           , center = TRUE, scale = TRUE) # min
d$pre.max.n            <- scale(as.numeric(d$pre.max)           , center = TRUE, scale = TRUE) # max
d$pre.product.n        <- scale(as.numeric(d$pre.product)       , center = TRUE, scale = TRUE) # product (op.1*op.2)
d$pre.sum_squared.n    <- scale(as.numeric(d$pre.sum_squared)   , center = TRUE, scale = TRUE) # sum_squared ((op.1 + op.2)^2)
d$pre.sup_op_squared.n <- scale(as.numeric(d$pre.sum_op_squared), center = TRUE, scale = TRUE) # sum of squared operands (op.1^2 + op.2^2)
d$op.1.n               <- scale(as.numeric(d$op.1)              , center = TRUE, scale = TRUE) # op.1
d$op.2.n               <- scale(as.numeric(d$op.2)              , center = TRUE, scale = TRUE) # op.2

hist(d$pre.min.n,            breaks = 10)
hist(d$pre.max.n,            breaks = 10)
hist(d$pre.product.n ,       breaks = 10)
hist(d$pre.sum_squared.n,    breaks = 10)
hist(d$pre.sup_op_squared.n, breaks = 10)
hist(d$op.1.n,               breaks = 10)
hist(d$op.2.n,               breaks = 10)
```

```{r}
# SPECIFY THE GROUP
group_num = -0.5                                                                 # -0.5 ~ grade 1; 0.5 ~ grade 6

# Grade 1 ----------------------------------------------------------------------
m1 <- lmer(log(RT) ~ sum.f.n + (1 + sum.f.n|subject) + (1|item), data = filter(d, group.cod == group_num), REML = FALSE)
summary(m1)

performance::check_model(m1)

# predictions ------------------------------------------------------------------

pre.m1 <- ggpredict(m1, terms = "sum.f.n", se = TRUE, back.transform = FALSE)
pre.m1
plot(pre.m1)

# sum.f.n | Predicted |       95% CI
# ----------------------------------
#   -1.22 |      7.96 | [7.77, 8.15]
#    0.01 |      8.21 | [8.04, 8.38]
#    1.24 |      8.46 | [8.24, 8.68]
```
# Probando visualizar los datos
ggplot(data = d, 
       aes(x = sum.f.n, 
           y = log(RT))) +
  geom_smooth(method = "lm") +
  labs(title = "",
       x = "Sum",
       y = "Solution time") +
  scale_x_continuous(breaks = c(-1.21568, 0.00974, 1.23515), 
                     labels = c(3, 4, 5)) 

<!-- # + -->
<!-- #   scale_y_continuous(breaks = c(log(1000), log(3000), log(5000), log(7000), log(9000), log(11000)), -->
<!-- #                      labels = c("1000", "3000", "5000", "7000", "9000", "11000")) -->




  labs(title = "",
       x = "Sum",
       y = "Solution time") +
  scale_x_continuous(breaks = c(-1.21568, 0.00974, 1.23515), labels = c(3, 4, 5)) +
  scale_y_continuous(breaks = c(log(1000), log(3000), log(5000), log(7000), log(9000), log(11000)),
                     labels = c("1000", "3000", "5000", "7000", "9000", "11000"))

ggplot(data = pre.m1, 
       aes(x = x, 
           y = predicted)) +
  geom_smooth(method = "lm") +
  labs(title = "",
       x = "Sum",
       y = "Solution time") +
  scale_x_continuous(breaks = c(-1.21568, 0.00974, 1.23515), labels = c(3, 4, 5)) +
  scale_y_continuous(breaks = c(log(3000)),
                     labels = c("3000"))
  
log(1000)

pre.m1$predicted




```{r}
## Control models:
# square -----------------------------------------------------------------------
m1.sq <- lmer(log(RT) ~ sum.f.n + I(sum.f.n^2) + (1 + sum.f.n + I(sum.f.n^2)|subject) + (1|item), data = filter(d, group.cod == -0.5), REML = FALSE)
summary(m1.sq)

# cubic ------------------------------------------------------------------------ NO puedo evaluarlo


## Alternative predictors ------------------------------------------------------
m1.e1 <- lmer(log(RT) ~ pre.min.n +            (1 + pre.min.n|subject) +            (1|item), data = filter(d, group.cod == group_num), REML = FALSE)
m1.e2 <- lmer(log(RT) ~ pre.max.n +            (1 + pre.max.n|subject) +            (1|item), data = filter(d, group.cod == group_num), REML = FALSE)
m1.e3 <- lmer(log(RT) ~ pre.product.n +        (1 + pre.product.n|subject) +        (1|item), data = filter(d, group.cod == group_num), REML = FALSE)
m1.e4 <- lmer(log(RT) ~ pre.sum_squared.n +    (1 + pre.sum_squared.n|subject) +    (1|item), data = filter(d, group.cod == group_num), REML = FALSE)
m1.e5 <- lmer(log(RT) ~ pre.sup_op_squared.n + (1 + pre.sup_op_squared.n|subject) + (1|item), data = filter(d, group.cod == group_num), REML = FALSE)
m1.e6 <- lmer(log(RT) ~ op.1.n +               (1 + op.1.n|subject) +               (1|item), data = filter(d, group.cod == group_num), REML = FALSE)
m1.e7 <- lmer(log(RT) ~ op.2.n +               (1 + op.2.n|subject) +               (1|item), data = filter(d, group.cod == group_num), REML = FALSE)

aov_table <- anova(m1,
                   m1.e1, 
                   m1.e2, 
                   m1.e3, 
                   m1.e4, 
                   m1.e5,
                   m1.e6,
                   m1.e7
                   )
```

# Change the names for each table ----------------------------------------------
```{r}
group_name = "grade 1"                                                          # grade 1 or grade 6
problem_type = "non-tie"                                                        # non-tie or tie
problem_size = "very small"                                                     # very small, medium small, large, small
```

# TABLE 1: Models and control models -------------------------------------------
```{r}
table.1 <- matrix(NA, nrow = 8, ncol = 13)
colnames(table.1) <- c("age_group",
                        "problem_type",
                        "problem_size",
                        "VI",
                        "intercept estimate [log]",
                        "VI estimate [log]",
                        "SE",
                        "df",
                        "t.val",
                        "p.val",
                        "AIC",
                        "BIC",
                       "note")

table.1[,4] <- c("Sum", "Min(op.1|op.2)", "Max(op.1|op.2)", "product ~ (op.1*op.2)", "sum_sq ~ (op.1+op.2)^2", "sum_sq_op ~ op.1^2+op.2^2", "op.1", "op.2")

table.1[,1] <- group_name
table.1[,2] <- problem_type
table.1[,3] <- problem_size

View(table.1)

table.1[1,5] <- round(summary(m1)$coef[1,1], 2)
table.1[1,6] <- round(summary(m1)$coef[2,1], 2)
table.1[1,7] <- round(summary(m1)$coef[2,2], 2)
table.1[1,8] <- round(summary(m1)$coef[2,3], 2)
table.1[1,9] <- round(summary(m1)$coef[2,4], 2)
table.1[1,10]<- round(summary(m1)$coef[2,5], 5)
#------------------------------------------------------------------------------ Min
table.1[2,5] <- round(summary(m1.e1)$coef[1,1], 2)
table.1[2,6] <- round(summary(m1.e1)$coef[2,1], 2)
table.1[2,7] <- round(summary(m1.e1)$coef[2,2], 2)
table.1[2,8] <- round(summary(m1.e1)$coef[2,3], 2)
table.1[2,9] <- round(summary(m1.e1)$coef[2,4], 2)
table.1[2,10]<- round(summary(m1.e1)$coef[2,5], 5)
#-------------------------------.---------------------------------- Max
table.1[3,5] <- round(summary(m1.e2)$coef[1,1], 2)
table.1[3,6] <- round(summary(m1.e2)$coef[2,1], 2)
table.1[3,7] <- round(summary(m1.e2)$coef[2,2], 2)
table.1[3,8] <- round(summary(m1.e2)$coef[2,3], 2)
table.1[3,9] <- round(summary(m1.e2)$coef[2,4], 2)
table.1[3,10]<- round(summary(m1.e2)$coef[2,5], 5)
#-------------------------------.---------------------------------- product
table.1[4,5] <- round(summary(m1.e3)$coef[1,1], 2)
table.1[4,6] <- round(summary(m1.e3)$coef[2,1], 2)
table.1[4,7] <- round(summary(m1.e3)$coef[2,2], 2)
table.1[4,8] <- round(summary(m1.e3)$coef[2,3], 2)
table.1[4,9] <- round(summary(m1.e3)$coef[2,4], 2)
table.1[4,10]<- round(summary(m1.e3)$coef[2,5], 5)
#-------------------------------.---------------------------------- sum_sq
table.1[5,5] <- round(summary(m1.e4)$coef[1,1], 2)
table.1[5,6] <- round(summary(m1.e4)$coef[2,1], 2)
table.1[5,7] <- round(summary(m1.e4)$coef[2,2], 2)
table.1[5,8] <- round(summary(m1.e4)$coef[2,3], 2)
table.1[5,9] <- round(summary(m1.e4)$coef[2,4], 2)
table.1[5,10]<- round(summary(m1.e4)$coef[2,5], 5)
#-------------------------------.---------------------------------- sum_sq_op
table.1[6,5] <- round(summary(m1.e5)$coef[1,1], 2)
table.1[6,6] <- round(summary(m1.e5)$coef[2,1], 2)
table.1[6,7] <- round(summary(m1.e5)$coef[2,2], 2)
table.1[6,8] <- round(summary(m1.e5)$coef[2,3], 2)
table.1[6,9] <- round(summary(m1.e5)$coef[2,4], 2)
table.1[6,10]<- round(summary(m1.e5)$coef[2,5], 5)
#-------------------------------.---------------------------------- op.1
table.1[7,5] <- round(summary(m1.e6)$coef[1,1], 2)
table.1[7,6] <- round(summary(m1.e6)$coef[2,1], 2)
table.1[7,7] <- round(summary(m1.e6)$coef[2,2], 2)
table.1[7,8] <- round(summary(m1.e6)$coef[2,3], 2)
table.1[7,9] <- round(summary(m1.e6)$coef[2,4], 2)
table.1[7,10]<- round(summary(m1.e6)$coef[2,5], 5)
#-------------------------------.---------------------------------- op.2
table.1[8,5] <- round(summary(m1.e7)$coef[1,1], 2)
table.1[8,6] <- round(summary(m1.e7)$coef[2,1], 2)
table.1[8,7] <- round(summary(m1.e7)$coef[2,2], 2)
table.1[8,8] <- round(summary(m1.e7)$coef[2,3], 2)
table.1[8,9] <- round(summary(m1.e7)$coef[2,4], 2)
table.1[8,10]<- round(summary(m1.e7)$coef[2,5], 5)

table.1[,11]  <- round(aov_table[,2], 2)
table.1[,12]  <- round(aov_table[,3], 2)

# table.1[1,13] <- "singular"                                                     # m1
# table.1[2,13] <- "singular"                                                     # m1.e1
# table.1[3,13] <- "singular"                                                     # m1.e2
# table.1[4,13] <- "singular"                                                     # m1.e3
# table.1[5,13] <- "singular"                                                     # m1.e4
# table.1[6,13] <- "singular"                                                     # m1.e5
# table.1[7,13] <- "singular"                                                     # m1.e6
# table.1[8,13] <- "singular"                                                     # m1.e7

View(table.1)
```

# CHANGE THE NAME HERE:
```{r}
table_vS.G1 <- table.1 %>% as.tibble()
write.csv(table_vS.G1, "table_vS.G1.csv")
```

# TABLE 2: higher order polynomials --------------------------------------------
```{r}
table.2 <- matrix(NA, nrow = 6, ncol = 12) 

colnames(table.2) <- c("age_group",
                        "problem_type",
                        "problem_size",
                        "model",
                        "VI",
                        "intercept estimate [log]",
                        "VI estimate [log]",
                        "SE",
                        "df",
                        "t.val",
                        "p.val",
                         "note")

table.2[,4] <- c("lineal", "cuadratic", "cuadratic", "cubic", "cubic", "cubic")
table.2[,5] <- c("Sum", "Sum", "Sum^2", "Sum", "Sum^2", "Sum^3")

table.2[,1] <- group_name
table.2[,2] <- problem_type
table.2[,3] <- problem_size

View(table.2)

# linear
table.2[1,6]  <- round(summary(m1)$coef[1,1], 2)                                  # intercept estimate
table.2[1,7]  <- round(summary(m1)$coef[2,1], 2)                                  # VI estimate
table.2[1,8]  <- round(summary(m1)$coef[2,2], 2)                                  # SE
table.2[1,9]  <- round(summary(m1)$coef[2,3], 2)                                  # df
table.2[1,10] <- round(summary(m1)$coef[2,4], 2)                                  # t.val
table.2[1,11] <- round(summary(m1)$coef[2,5], 5)                                  # p.val
# cuadratic --------------------------------------------------------  
table.2[2,6]  <- round(summary(m1.sq)$coef[1,1], 2)                               # intercept estimate
table.2[2,7]  <- round(summary(m1.sq)$coef[2,1], 2)                               # VI estimate
table.2[2,8]  <- round(summary(m1.sq)$coef[2,2], 2)                               # SE
table.2[2,9]  <- round(summary(m1.sq)$coef[2,3], 2)                               # df
table.2[2,10] <- round(summary(m1.sq)$coef[2,4], 2)                               # t.val
table.2[2,11] <- round(summary(m1.sq)$coef[2,5], 5)                               # p.val
# ----------------------------------------------------------------  
table.2[3,6]  <- round(summary(m1.sq)$coef[1,1], 2)                               # intercept estimate
table.2[3,7]  <- round(summary(m1.sq)$coef[3,1], 2)                               # VI estimate
table.2[3,8]  <- round(summary(m1.sq)$coef[3,2], 2)                               # SE
table.2[3,9]  <- round(summary(m1.sq)$coef[3,3], 2)                               # df
table.2[3,10] <- round(summary(m1.sq)$coef[3,4], 2)                               # t.val
table.2[3,11] <- round(summary(m1.sq)$coef[3,5], 5)                               # p.val
# # cubic ---------------------------------------------------------
# table.2[4,6]  <- round(summary(m1.cu)$coef[1,1], 2)                             # intercept estimate
# table.2[4,7]  <- round(summary(m1.cu)$coef[2,1], 2)                             # VI estimate
# table.2[4,8]  <- round(summary(m1.cu)$coef[2,2], 2)                             # SE
# table.2[4,9]  <- round(summary(m1.cu)$coef[2,3], 2)                             # df
# table.2[4,10] <- round(summary(m1.cu)$coef[2,4], 2)                             # t.val
# table.2[4,11] <- round(summary(m1.cu)$coef[2,5], 5)                             # p.val
# # ----------------------------------------------------------------
# table.2[5,6]  <- round(summary(m1.cu)$coef[1,1], 2)                             # intercept estimate
# table.2[5,7]  <- round(summary(m1.cu)$coef[3,1], 2)                             # VI estimate
# table.2[5,8]  <- round(summary(m1.cu)$coef[3,2], 2)                             # SE
# table.2[5,9]  <- round(summary(m1.cu)$coef[3,3], 2)                             # df
# table.2[5,10] <- round(summary(m1.cu)$coef[3,4], 2)                             # t.val
# table.2[5,11] <- round(summary(m1.cu)$coef[3,5], 5)                             # p.val
# # ----------------------------------------------------------------
# table.2[6,6]  <- round(summary(m1.cu)$coef[1,1], 2)                             # intercept estimate
# table.2[6,7]  <- round(summary(m1.cu)$coef[4,1], 2)                             # VI estimate
# table.2[6,8]  <- round(summary(m1.cu)$coef[4,2], 2)                             # SE
# table.2[6,9]  <- round(summary(m1.cu)$coef[4,3], 2)                             # df
# table.2[6,10] <- round(summary(m1.cu)$coef[4,4], 2)                             # t.val
# table.2[6,11] <- round(summary(m1.cu)$coef[4,5], 5)                             # p.val

table.2[4,11] <- "cannot evaluate"
table.2[5,11] <- "cannot evaluate"
table.2[6,11] <- "cannot evaluate"

View(table.2)
```

# CHANGE THE NAMES HERE --------------------------------------------------------
```{r}
table_vS.G1.poly <- table.2 %>% as.tibble
write.csv(table_vS.G1.poly, "table_vS.G1.poly.csv")
```

# remove the objects
```{r}
rm(group_name, group_num, problem_size, problem_type, m1, pre.m1, m1.e1, m1.e2, m1.e3, m1.e4, m1.e5, m1.e6, m1.e7, m1.sq, m1.cu, aov_table, table.1, table.2)
```

```{r}
# SPECIFY THE GROUP
group_num = 0.5                                                                 # -0.5 ~ grade 1; 0.5 ~ grade 6

# Grade 6 ----------------------------------------------------------------------
m1  <- lmer(log(RT) ~ sum.f.n + (1 + sum.f.n|subject) + (1|item), data = filter(d, group.cod == group_num), REML = FALSE)
summary(m1)
# singular por el item, tendría que agrupar los datos pero no quiero porque así no tengo en cuenta que los ítems se repiten; por otra parte son muy pocos ítems

performance::check_model(m1)


# Lo agrupo y los resultados son exactamente los mismos:

# d.bysubj <- d %>% filter(group.cod == group_num) %>% group_by(subject, sum.f.n) %>% summarize(RT = mean(log(RT)))
# m1  <- lmer(RT ~ sum.f.n + (1 + sum.f.n|subject), data = d.bysubj, REML = FALSE)
# summary(m1)
# #singular
# 
# m1  <- lmer(RT ~ sum.f.n + (1 + sum.f.n||subject), data = d.bysubj, REML = FALSE)
# summary(m1)
# performance::check_model(m1)

# predictions ------------------------------------------------------------------

pre.m1 <- ggpredict(m1, terms = "sum.f.n", se = TRUE, back.transform = FALSE)
pre.m1
plot(pre.m1)
  
# sum.f.n | Predicted |       95% CI
# ----------------------------------
#   -1.22 |      7.14 | [7.05, 7.24]
#    0.01 |      7.30 | [7.19, 7.42]
#    1.24 |      7.47 | [7.31, 7.63]
```


```{r}
## Control models:
# square -----------------------------------------------------------------------
m1.sq <- lmer(log(RT) ~ sum.f.n + I(sum.f.n^2) + (1 + sum.f.n + I(sum.f.n^2)|subject) + (1|item), data = filter(d, group.cod == group_num), REML = FALSE)
summary(m1.sq)
# singular por el item

# cubic ------------------------------------------------------------------------ NO puedo evaluarlo


## Alternative predictors ------------------------------------------------------
m1.e1 <- lmer(log(RT) ~ pre.min.n +            (1 + pre.min.n|subject) +            (1|item), data = filter(d, group.cod == group_num), REML = FALSE)
m1.e2 <- lmer(log(RT) ~ pre.max.n +            (1 + pre.max.n|subject) +            (1|item), data = filter(d, group.cod == group_num), REML = FALSE)
m1.e3 <- lmer(log(RT) ~ pre.product.n +        (1 + pre.product.n|subject) +        (1|item), data = filter(d, group.cod == group_num), REML = FALSE) #singular
summary(m1.e3) #otra vez por el ítem
m1.e4 <- lmer(log(RT) ~ pre.sum_squared.n +    (1 + pre.sum_squared.n|subject) +    (1|item), data = filter(d, group.cod == group_num), REML = FALSE) #singular
summary(m1.e4) #por el ítem
m1.e5 <- lmer(log(RT) ~ pre.sup_op_squared.n + (1 + pre.sup_op_squared.n|subject) + (1|item), data = filter(d, group.cod == group_num), REML = FALSE) #singular
summary(m1.e5) #por el ítem
m1.e6 <- lmer(log(RT) ~ op.1.n +               (1 + op.1.n|subject) +               (1|item), data = filter(d, group.cod == group_num), REML = FALSE)
m1.e7 <- lmer(log(RT) ~ op.2.n +               (1 + op.2.n|subject) +               (1|item), data = filter(d, group.cod == group_num), REML = FALSE)

aov_table <- anova(m1,
             m1.e1, 
             m1.e2, 
             m1.e3, 
             m1.e4, 
             m1.e5,
             m1.e6,
             m1.e7
             )

# m0  <- lmer(log(RT) ~ 1 + (1|subject) + (1|item), data = filter(d, group.cod == group_num), REML = FALSE)
# anova(m0, m1)
# 
# m0  <- lmer(log(RT) ~ 1 + (1|subject) + (1|item), data = filter(d, group.cod == group_num), REML = TRUE)
# anova(m0, m1.e1)
# 
# anova(m1,m1.e1, df = "Kenward-Roger")
# anova(m1,m1.e3)
# anova(m0, m1.e1)

```

AGRUPAR O NO AGRUPAR eso es la cuestión
algunos modelos me salen singulares

# Change the names for each table ----------------------------------------------
```{r}
group_name = "grade 6"                                                          # grade 1 or grade 6
problem_type = "non-tie"                                                        # non-tie or tie
problem_size = "very small"                                                     # very small, medium small, large, small
```

# TABLE 1: Models and control models -------------------------------------------
```{r}
table.1 <- matrix(NA, nrow = 8, ncol = 13)
colnames(table.1) <- c("age_group",
                        "problem_type",
                        "problem_size",
                        "VI",
                        "intercept estimate [log]",
                        "VI estimate [log]",
                        "SE",
                        "df",
                        "t.val",
                        "p.val",
                        "AIC",
                        "BIC",
                        "note")

table.1[,4] <- c("Sum", "Min(op.1|op.2)", "Max(op.1|op.2)", "product ~ (op.1*op.2)", "sum_sq ~ (op.1+op.2)^2", "sum_sq_op ~ op.1^2+op.2^2", "op.1", "op.2")

table.1[,1] <- group_name
table.1[,2] <- problem_type
table.1[,3] <- problem_size

View(table.1)

table.1[1,5] <- round(summary(m1)$coef[1,1], 2)
table.1[1,6] <- round(summary(m1)$coef[2,1], 2)
table.1[1,7] <- round(summary(m1)$coef[2,2], 2)
table.1[1,8] <- round(summary(m1)$coef[2,3], 2)
table.1[1,9] <- round(summary(m1)$coef[2,4], 2)
table.1[1,10]<- round(summary(m1)$coef[2,5], 5)
#------------------------------------------------------------------------------ Min
table.1[2,5] <- round(summary(m1.e1)$coef[1,1], 2)
table.1[2,6] <- round(summary(m1.e1)$coef[2,1], 2)
table.1[2,7] <- round(summary(m1.e1)$coef[2,2], 2)
table.1[2,8] <- round(summary(m1.e1)$coef[2,3], 2)
table.1[2,9] <- round(summary(m1.e1)$coef[2,4], 2)
table.1[2,10]<- round(summary(m1.e1)$coef[2,5], 5)
#-------------------------------.---------------------------------- Max
table.1[3,5] <- round(summary(m1.e2)$coef[1,1], 2)
table.1[3,6] <- round(summary(m1.e2)$coef[2,1], 2)
table.1[3,7] <- round(summary(m1.e2)$coef[2,2], 2)
table.1[3,8] <- round(summary(m1.e2)$coef[2,3], 2)
table.1[3,9] <- round(summary(m1.e2)$coef[2,4], 2)
table.1[3,10]<- round(summary(m1.e2)$coef[2,5], 5)
#-------------------------------.---------------------------------- product
table.1[4,5] <- round(summary(m1.e3)$coef[1,1], 2)
table.1[4,6] <- round(summary(m1.e3)$coef[2,1], 2)
table.1[4,7] <- round(summary(m1.e3)$coef[2,2], 2)
table.1[4,8] <- round(summary(m1.e3)$coef[2,3], 2)
table.1[4,9] <- round(summary(m1.e3)$coef[2,4], 2)
table.1[4,10]<- round(summary(m1.e3)$coef[2,5], 5)
#-------------------------------.---------------------------------- sum_sq
table.1[5,5] <- round(summary(m1.e4)$coef[1,1], 2)
table.1[5,6] <- round(summary(m1.e4)$coef[2,1], 2)
table.1[5,7] <- round(summary(m1.e4)$coef[2,2], 2)
table.1[5,8] <- round(summary(m1.e4)$coef[2,3], 2)
table.1[5,9] <- round(summary(m1.e4)$coef[2,4], 2)
table.1[5,10]<- round(summary(m1.e4)$coef[2,5], 5)
#-------------------------------.---------------------------------- sum_sq_op
table.1[6,5] <- round(summary(m1.e5)$coef[1,1], 2)
table.1[6,6] <- round(summary(m1.e5)$coef[2,1], 2)
table.1[6,7] <- round(summary(m1.e5)$coef[2,2], 2)
table.1[6,8] <- round(summary(m1.e5)$coef[2,3], 2)
table.1[6,9] <- round(summary(m1.e5)$coef[2,4], 2)
table.1[6,10]<- round(summary(m1.e5)$coef[2,5], 5)
#-------------------------------.---------------------------------- op.1
table.1[7,5] <- round(summary(m1.e6)$coef[1,1], 2)
table.1[7,6] <- round(summary(m1.e6)$coef[2,1], 2)
table.1[7,7] <- round(summary(m1.e6)$coef[2,2], 2)
table.1[7,8] <- round(summary(m1.e6)$coef[2,3], 2)
table.1[7,9] <- round(summary(m1.e6)$coef[2,4], 2)
table.1[7,10]<- round(summary(m1.e6)$coef[2,5], 5)
#-------------------------------.---------------------------------- op.2
table.1[8,5] <- round(summary(m1.e7)$coef[1,1], 2)
table.1[8,6] <- round(summary(m1.e7)$coef[2,1], 2)
table.1[8,7] <- round(summary(m1.e7)$coef[2,2], 2)
table.1[8,8] <- round(summary(m1.e7)$coef[2,3], 2)
table.1[8,9] <- round(summary(m1.e7)$coef[2,4], 2)
table.1[8,10]<- round(summary(m1.e7)$coef[2,5], 5)

table.1[,11]  <- round(aov_table[,2], 2)
table.1[,12]  <- round(aov_table[,3], 2)

table.1[1,13] <- "singular"                                                     # m1
# table.1[2,13] <- "singular"                                                     # m1.e1
# table.1[3,13] <- "singular"                                                     # m1.e2
table.1[4,13] <- "singular"                                                     # m1.e3
table.1[5,13] <- "singular"                                                     # m1.e4
table.1[6,13] <- "singular"                                                     # m1.e5
# table.1[7,13] <- "singular"                                                     # m1.e6
# table.1[8,13] <- "singular"                                                     # m1.e7

View(table.1)
```

#CHANGE THE NAME HERE:
```{r}
table_vS.G6 <- table.1 %>% as.tibble()
write.csv(table_vS.G6, "table_vS.G6.csv")
```

# TABLE 2: higher order polynomials --------------------------------------------
```{r}
table.2 <- matrix(NA, nrow = 6, ncol = 12) 

colnames(table.2) <- c("age_group",
                        "problem_type",
                        "problem_size",
                        "model",
                        "VI",
                        "intercept estimate [log]",
                        "VI estimate [log]",
                        "SE",
                        "df",
                        "t.val",
                        "p.val",
                         "note")

table.2[,4] <- c("lineal", "cuadratic", "cuadratic", "cubic", "cubic", "cubic")
table.2[,5] <- c("Sum", "Sum", "Sum^2", "Sum", "Sum^2", "Sum^3")

table.2[,1] <- group_name
table.2[,2] <- problem_type
table.2[,3] <- problem_size

View(table.2)

# linear
table.2[1,6]  <- round(summary(m1)$coef[1,1], 2)                                # intercept estimate
table.2[1,7]  <- round(summary(m1)$coef[2,1], 2)                                # VI estimate
table.2[1,8]  <- round(summary(m1)$coef[2,2], 2)                                # SE
table.2[1,9]  <- round(summary(m1)$coef[2,3], 2)                                # df
table.2[1,10] <- round(summary(m1)$coef[2,4], 2)                                # t.val
table.2[1,11] <- round(summary(m1)$coef[2,5], 5)                                # p.val
# cuadratic --------------------------------------------------------
table.2[2,6]  <- round(summary(m1.sq)$coef[1,1], 2)                             # intercept estimate
table.2[2,7]  <- round(summary(m1.sq)$coef[2,1], 2)                             # VI estimate
table.2[2,8]  <- round(summary(m1.sq)$coef[2,2], 2)                             # SE
table.2[2,9]  <- round(summary(m1.sq)$coef[2,3], 2)                             # df
table.2[2,10] <- round(summary(m1.sq)$coef[2,4], 2)                             # t.val
table.2[2,11] <- round(summary(m1.sq)$coef[2,5], 5)                             # p.val
# ----------------------------------------------------------------
table.2[3,6]  <- round(summary(m1.sq)$coef[1,1], 2)                             # intercept estimate
table.2[3,7]  <- round(summary(m1.sq)$coef[3,1], 2)                             # VI estimate
table.2[3,8]  <- round(summary(m1.sq)$coef[3,2], 2)                             # SE
table.2[3,9]  <- round(summary(m1.sq)$coef[3,3], 2)                             # df
table.2[3,10] <- round(summary(m1.sq)$coef[3,4], 2)                             # t.val
table.2[3,11] <- round(summary(m1.sq)$coef[3,5], 5)                             # p.val
# # cubic ---------------------------------------------------------
# table.2[4,6]  <- round(summary(m1.cu)$coef[1,1], 2)                             # intercept estimate
# table.2[4,7]  <- round(summary(m1.cu)$coef[2,1], 2)                             # VI estimate
# table.2[4,8]  <- round(summary(m1.cu)$coef[2,2], 2)                             # SE
# table.2[4,9]  <- round(summary(m1.cu)$coef[2,3], 2)                             # df
# table.2[4,10] <- round(summary(m1.cu)$coef[2,4], 2)                             # t.val
# table.2[4,11] <- round(summary(m1.cu)$coef[2,5], 5)                             # p.val
# # ----------------------------------------------------------------
# table.2[5,6]  <- round(summary(m1.cu)$coef[1,1], 2)                             # intercept estimate
# table.2[5,7]  <- round(summary(m1.cu)$coef[3,1], 2)                             # VI estimate
# table.2[5,8]  <- round(summary(m1.cu)$coef[3,2], 2)                             # SE
# table.2[5,9]  <- round(summary(m1.cu)$coef[3,3], 2)                             # df
# table.2[5,10] <- round(summary(m1.cu)$coef[3,4], 2)                             # t.val
# table.2[5,11] <- round(summary(m1.cu)$coef[3,5], 5)                             # p.val
# # ----------------------------------------------------------------
# table.2[6,6]  <- round(summary(m1.cu)$coef[1,1], 2)                             # intercept estimate
# table.2[6,7]  <- round(summary(m1.cu)$coef[4,1], 2)                             # VI estimate
# table.2[6,8]  <- round(summary(m1.cu)$coef[4,2], 2)                             # SE
# table.2[6,9]  <- round(summary(m1.cu)$coef[4,3], 2)                             # df
# table.2[6,10] <- round(summary(m1.cu)$coef[4,4], 2)                             # t.val
# table.2[6,11] <- round(summary(m1.cu)$coef[4,5], 5)                             # p.val

table.2[1,11] <- "singular"
table.2[2,11] <- "singular"
table.2[3,11] <- "singular"

table.2[4,11] <- "cannot evaluate"
table.2[5,11] <- "cannot evaluate"
table.2[6,11] <- "cannot evaluate"

View(table.2)
```

# CHANGE THE NAMES HERE --------------------------------------------------------
```{r}
table_vS.G6.poly <- table.2 %>% as.tibble
write.csv(table_vS.G6.poly, "table_vS.G6.poly.csv")
```

#remove the objects
```{r}
rm(d, group_name, group_num, problem_size, problem_type, m1, pre.m1, m1.e1, m1.e2, m1.e3, m1.e4, m1.e5, m1.e6, m1.e7, m1.sq, m1.cu, aov_table, table.1, table.2)
```

# Medium-small non-ties --------------------------------------------------------
```{r}
d <- d.outliers_without %>% 
  filter(n.tie_medium == 1)

d$sum.f.n <- scale(as.numeric(d$sum.f))
hist(d$sum.f.n, breaks = 20)

xtabs(~ sum.f + group.cod, data = d)

# Alternative predictors -------------------------------------------------------

d$pre.min.n            <- scale(as.numeric(d$pre.min)           , center = TRUE, scale = TRUE) # min
d$pre.max.n            <- scale(as.numeric(d$pre.max)           , center = TRUE, scale = TRUE) # max
d$pre.product.n        <- scale(as.numeric(d$pre.product)       , center = TRUE, scale = TRUE) # product (op.1*op.2)
d$pre.sum_squared.n    <- scale(as.numeric(d$pre.sum_squared)   , center = TRUE, scale = TRUE) # sum_squared ((op.1 + op.2)^2)
d$pre.sup_op_squared.n <- scale(as.numeric(d$pre.sum_op_squared), center = TRUE, scale = TRUE) # sum of squared operands (op.1^2 + op.2^2)
d$op.1.n               <- scale(as.numeric(d$op.1)              , center = TRUE, scale = TRUE) # op.1
d$op.2.n               <- scale(as.numeric(d$op.2)              , center = TRUE, scale = TRUE) # op.2

hist(d$pre.min.n,            breaks = 10)
hist(d$pre.max.n,            breaks = 10)
hist(d$pre.product.n ,       breaks = 10)
hist(d$pre.sum_squared.n,    breaks = 10)
hist(d$pre.sup_op_squared.n, breaks = 10)
hist(d$op.1.n,               breaks = 10)
hist(d$op.2.n,               breaks = 10)
```

```{r}
# SPECIFY THE GROUP
group_num = -0.5                                                                 # -0.5 ~ grade 1; 0.5 ~ grade 6

# Grade 1 ----------------------------------------------------------------------
m1 <- lmer(log(RT) ~ sum.f.n + (1 + sum.f.n|subject) + (1|item), data = filter(d, group.cod == group_num), REML = FALSE)
summary(m1)

performance::check_model(m1)

# predictions ------------------------------------------------------------------

pre.m1 <- ggpredict(m1, terms = "sum.f.n", se = TRUE, back.transform = FALSE)
pre.m1
plot(pre.m1)

# sum.f.n | Predicted |       95% CI
# ----------------------------------
#   -1.90 |      8.17 | [7.96, 8.37]
#   -0.89 |      8.28 | [8.12, 8.45]
#    0.12 |      8.40 | [8.24, 8.55]
#    1.12 |      8.51 | [8.33, 8.70]
```


```{r}
## Control models:
# square -----------------------------------------------------------------------
m1.sq <- lmer(log(RT) ~ sum.f.n + I(sum.f.n^2) + (1 + sum.f.n + I(sum.f.n^2)|subject) + (1|item), data = filter(d, group.cod == -0.5), REML = FALSE)
summary(m1.sq)

# cubic ------------------------------------------------------------------------
# m1.cu <- lmer(log(RT) ~ sum.f.n + I(sum.f.n^2) + I(sum.f.n^3) + (1 + sum.f.n + I(sum.f.n^2) + I(sum.f.n^3)|subject) + (1|item), data = filter(d, group.cod == -0.5), REML = FALSE)
# # failed to converge
# summary(m1.cu)

m1.cu <- lmer(log(RT) ~ sum.f.n + I(sum.f.n^2) + I(sum.f.n^3) + (1 + sum.f.n + I(sum.f.n^2)|subject) + (1|item), data = filter(d, group.cod == -0.5), REML = FALSE)
summary(m1.cu)


## Alternative predictors ------------------------------------------------------

m1.e1 <- lmer(log(RT) ~ pre.min.n +            (1 + pre.min.n|subject) +            (1|item), data = filter(d, group.cod == group_num), REML = FALSE)
m1.e2 <- lmer(log(RT) ~ pre.max.n +            (1 + pre.max.n|subject) +            (1|item), data = filter(d, group.cod == group_num), REML = FALSE)
m1.e3 <- lmer(log(RT) ~ pre.product.n +        (1 + pre.product.n|subject) +        (1|item), data = filter(d, group.cod == group_num), REML = FALSE)
m1.e4 <- lmer(log(RT) ~ pre.sum_squared.n +    (1 + pre.sum_squared.n|subject) +    (1|item), data = filter(d, group.cod == group_num), REML = FALSE)
m1.e5 <- lmer(log(RT) ~ pre.sup_op_squared.n + (1 + pre.sup_op_squared.n|subject) + (1|item), data = filter(d, group.cod == group_num), REML = FALSE)
m1.e6 <- lmer(log(RT) ~ op.1.n +               (1 + op.1.n|subject) +               (1|item), data = filter(d, group.cod == group_num), REML = FALSE) #singular
m1.e7 <- lmer(log(RT) ~ op.2.n +               (1 + op.2.n|subject) +               (1|item), data = filter(d, group.cod == group_num), REML = FALSE) #singular

aov_table <- anova(m1,
             m1.e1, 
             m1.e2, 
             m1.e3, 
             m1.e4, 
             m1.e5,
             m1.e6,
             m1.e7
             )
```

# Change the names for each table ----------------------------------------------
```{r}
group_name = "grade 1"                                                          # grade 1 or grade 6
problem_type = "non-tie"                                                        # non-tie or tie
problem_size = "medium small"                                                   # very small, medium small, large, small
```

# TABLE 1: Models and control models -------------------------------------------
```{r}
table.1 <- matrix(NA, nrow = 8, ncol = 13)
colnames(table.1) <- c("age_group",
                        "problem_type",
                        "problem_size",
                        "VI",
                        "intercept estimate [log]",
                        "VI estimate [log]",
                        "SE",
                        "df",
                        "t.val",
                        "p.val",
                        "AIC",
                        "BIC",
                       "note")

table.1[,4] <- c("Sum", "Min(op.1|op.2)", "Max(op.1|op.2)", "product ~ (op.1*op.2)", "sum_sq ~ (op.1+op.2)^2", "sum_sq_op ~ op.1^2+op.2^2", "op.1", "op.2")

table.1[,1] <- group_name
table.1[,2] <- problem_type
table.1[,3] <- problem_size

View(table.1)

table.1[1,5] <- round(summary(m1)$coef[1,1], 2)
table.1[1,6] <- round(summary(m1)$coef[2,1], 2)
table.1[1,7] <- round(summary(m1)$coef[2,2], 2)
table.1[1,8] <- round(summary(m1)$coef[2,3], 2)
table.1[1,9] <- round(summary(m1)$coef[2,4], 2)
table.1[1,10]<- round(summary(m1)$coef[2,5], 5)
#------------------------------------------------------------------------------ Min
table.1[2,5] <- round(summary(m1.e1)$coef[1,1], 2)
table.1[2,6] <- round(summary(m1.e1)$coef[2,1], 2)
table.1[2,7] <- round(summary(m1.e1)$coef[2,2], 2)
table.1[2,8] <- round(summary(m1.e1)$coef[2,3], 2)
table.1[2,9] <- round(summary(m1.e1)$coef[2,4], 2)
table.1[2,10]<- round(summary(m1.e1)$coef[2,5], 5)
#-------------------------------.---------------------------------- Max
table.1[3,5] <- round(summary(m1.e2)$coef[1,1], 2)
table.1[3,6] <- round(summary(m1.e2)$coef[2,1], 2)
table.1[3,7] <- round(summary(m1.e2)$coef[2,2], 2)
table.1[3,8] <- round(summary(m1.e2)$coef[2,3], 2)
table.1[3,9] <- round(summary(m1.e2)$coef[2,4], 2)
table.1[3,10]<- round(summary(m1.e2)$coef[2,5], 5)
#-------------------------------.---------------------------------- product
table.1[4,5] <- round(summary(m1.e3)$coef[1,1], 2)
table.1[4,6] <- round(summary(m1.e3)$coef[2,1], 2)
table.1[4,7] <- round(summary(m1.e3)$coef[2,2], 2)
table.1[4,8] <- round(summary(m1.e3)$coef[2,3], 2)
table.1[4,9] <- round(summary(m1.e3)$coef[2,4], 2)
table.1[4,10]<- round(summary(m1.e3)$coef[2,5], 5)
#-------------------------------.---------------------------------- sum_sq
table.1[5,5] <- round(summary(m1.e4)$coef[1,1], 2)
table.1[5,6] <- round(summary(m1.e4)$coef[2,1], 2)
table.1[5,7] <- round(summary(m1.e4)$coef[2,2], 2)
table.1[5,8] <- round(summary(m1.e4)$coef[2,3], 2)
table.1[5,9] <- round(summary(m1.e4)$coef[2,4], 2)
table.1[5,10]<- round(summary(m1.e4)$coef[2,5], 5)
#-------------------------------.---------------------------------- sum_sq_op
table.1[6,5] <- round(summary(m1.e5)$coef[1,1], 2)
table.1[6,6] <- round(summary(m1.e5)$coef[2,1], 2)
table.1[6,7] <- round(summary(m1.e5)$coef[2,2], 2)
table.1[6,8] <- round(summary(m1.e5)$coef[2,3], 2)
table.1[6,9] <- round(summary(m1.e5)$coef[2,4], 2)
table.1[6,10]<- round(summary(m1.e5)$coef[2,5], 5)
#-------------------------------.---------------------------------- op.1
table.1[7,5] <- round(summary(m1.e6)$coef[1,1], 2)
table.1[7,6] <- round(summary(m1.e6)$coef[2,1], 2)
table.1[7,7] <- round(summary(m1.e6)$coef[2,2], 2)
table.1[7,8] <- round(summary(m1.e6)$coef[2,3], 2)
table.1[7,9] <- round(summary(m1.e6)$coef[2,4], 2)
table.1[7,10]<- round(summary(m1.e6)$coef[2,5], 5)
#-------------------------------.---------------------------------- op.2
table.1[8,5] <- round(summary(m1.e7)$coef[1,1], 2)
table.1[8,6] <- round(summary(m1.e7)$coef[2,1], 2)
table.1[8,7] <- round(summary(m1.e7)$coef[2,2], 2)
table.1[8,8] <- round(summary(m1.e7)$coef[2,3], 2)
table.1[8,9] <- round(summary(m1.e7)$coef[2,4], 2)
table.1[8,10]<- round(summary(m1.e7)$coef[2,5], 5)

table.1[,11]  <- round(aov_table[,2], 2)
table.1[,12]  <- round(aov_table[,3], 2)

# table.1[1,13] <- "singular"                                                     # m1
# table.1[2,13] <- "singular"                                                     # m1.e1
# table.1[3,13] <- "singular"                                                     # m1.e2
# table.1[4,13] <- "singular"                                                     # m1.e3
# table.1[5,13] <- "singular"                                                     # m1.e4
# table.1[6,13] <- "singular"                                                     # m1.e5
table.1[7,13] <- "singular"                                                     # m1.e6
table.1[8,13] <- "singular"                                                     # m1.e7

View(table.1)
```

# CHANGE THE NAME HERE:
```{r}
table_mS.G1 <- table.1 %>% as.tibble()
write.csv(table_mS.G1, "table_mS.G1.csv")
```

# TABLE 2: higher order polynomials --------------------------------------------
```{r}
table.2 <- matrix(NA, nrow = 6, ncol = 12) 

colnames(table.2) <- c("age_group",
                        "problem_type",
                        "problem_size",
                        "model",
                        "VI",
                        "intercept estimate [log]",
                        "VI estimate [log]",
                        "SE",
                        "df",
                        "t.val",
                        "p.val",
                         "note")

table.2[,4] <- c("lineal", "cuadratic", "cuadratic", "cubic", "cubic", "cubic")
table.2[,5] <- c("Sum", "Sum", "Sum^2", "Sum", "Sum^2", "Sum^3")

table.2[,1] <- group_name
table.2[,2] <- problem_type
table.2[,3] <- problem_size

View(table.2)

# linear
table.2[1,6]  <- round(summary(m1)$coef[1,1], 2)                                # intercept estimate
table.2[1,7]  <- round(summary(m1)$coef[2,1], 2)                                # VI estimate
table.2[1,8]  <- round(summary(m1)$coef[2,2], 2)                                # SE
table.2[1,9]  <- round(summary(m1)$coef[2,3], 2)                                # df
table.2[1,10] <- round(summary(m1)$coef[2,4], 2)                                # t.val
table.2[1,11] <- round(summary(m1)$coef[2,5], 5)                                # p.val
# cuadratic --------------------------------------------------------
table.2[2,6]  <- round(summary(m1.sq)$coef[1,1], 2)                             # intercept estimate
table.2[2,7]  <- round(summary(m1.sq)$coef[2,1], 2)                             # VI estimate
table.2[2,8]  <- round(summary(m1.sq)$coef[2,2], 2)                             # SE
table.2[2,9]  <- round(summary(m1.sq)$coef[2,3], 2)                             # df
table.2[2,10] <- round(summary(m1.sq)$coef[2,4], 2)                             # t.val
table.2[2,11] <- round(summary(m1.sq)$coef[2,5], 5)                             # p.val
# ----------------------------------------------------------------
table.2[3,6]  <- round(summary(m1.sq)$coef[1,1], 2)                             # intercept estimate
table.2[3,7]  <- round(summary(m1.sq)$coef[3,1], 2)                             # VI estimate
table.2[3,8]  <- round(summary(m1.sq)$coef[3,2], 2)                             # SE
table.2[3,9]  <- round(summary(m1.sq)$coef[3,3], 2)                             # df
table.2[3,10] <- round(summary(m1.sq)$coef[3,4], 2)                             # t.val
table.2[3,11] <- round(summary(m1.sq)$coef[3,5], 5)                             # p.val
# cubic ---------------------------------------------------------
table.2[4,6]  <- round(summary(m1.cu)$coef[1,1], 2)                             # intercept estimate
table.2[4,7]  <- round(summary(m1.cu)$coef[2,1], 2)                             # VI estimate
table.2[4,8]  <- round(summary(m1.cu)$coef[2,2], 2)                             # SE
table.2[4,9]  <- round(summary(m1.cu)$coef[2,3], 2)                             # df
table.2[4,10] <- round(summary(m1.cu)$coef[2,4], 2)                             # t.val
table.2[4,11] <- round(summary(m1.cu)$coef[2,5], 5)                             # p.val
# ----------------------------------------------------------------
table.2[5,6]  <- round(summary(m1.cu)$coef[1,1], 2)                             # intercept estimate
table.2[5,7]  <- round(summary(m1.cu)$coef[3,1], 2)                             # VI estimate
table.2[5,8]  <- round(summary(m1.cu)$coef[3,2], 2)                             # SE
table.2[5,9]  <- round(summary(m1.cu)$coef[3,3], 2)                             # df
table.2[5,10] <- round(summary(m1.cu)$coef[3,4], 2)                             # t.val
table.2[5,11] <- round(summary(m1.cu)$coef[3,5], 5)                             # p.val
# ----------------------------------------------------------------
table.2[6,6]  <- round(summary(m1.cu)$coef[1,1], 2)                             # intercept estimate
table.2[6,7]  <- round(summary(m1.cu)$coef[4,1], 2)                             # VI estimate
table.2[6,8]  <- round(summary(m1.cu)$coef[4,2], 2)                             # SE
table.2[6,9]  <- round(summary(m1.cu)$coef[4,3], 2)                             # df
table.2[6,10] <- round(summary(m1.cu)$coef[4,4], 2)                             # t.val
table.2[6,11] <- round(summary(m1.cu)$coef[4,5], 5)                             # p.val


# table.2[4,11] <- "cannot evaluate"
# table.2[5,11] <- "cannot evaluate"
# table.2[6,11] <- "cannot evaluate"

View(table.2)
```

# CHANGE THE NAMES HERE --------------------------------------------------------
```{r}
table_mS.G1.poly <- table.2 %>% as.tibble
write.csv(table_mS.G1.poly, "table_mS.G1.poly.csv")
```

# remove the objects
```{r}
rm(group_name, group_num, problem_size, problem_type, m1, pre.m1, m1.e1, m1.e2, m1.e3, m1.e4, m1.e5, m1.e6, m1.e7, m1.sq, m1.cu, aov_table, table.1, table.2)
```

```{r}
# SPECIFY THE GROUP
group_num = 0.5                                                                 # -0.5 ~ grade 1; 0.5 ~ grade 6

# Grade 6 ----------------------------------------------------------------------
m1  <- lmer(log(RT) ~ sum.f.n + (1 + sum.f.n|subject) + (1|item), data = filter(d, group.cod == group_num), REML = FALSE)
summary(m1)

performance::check_model(m1)

# predictions ------------------------------------------------------------------

pre.m1 <- ggpredict(m1, terms = "sum.f.n", se = TRUE, back.transform = FALSE)
pre.m1
plot(pre.m1)

# sum.f.n | Predicted |       95% CI
# ----------------------------------
#   -1.90 |      7.31 | [7.17, 7.45]
#   -0.89 |      7.36 | [7.23, 7.48]
#    0.12 |      7.41 | [7.27, 7.54]
#    1.12 |      7.45 | [7.30, 7.61]

pre.m1 <- ggpredict(m1, terms = "sum.f.n", se = TRUE, back.transform = TRUE)
pre.m1
plot(pre.m1)

# sum.f.n | Predicted |             95% CI
# ----------------------------------------
#   -1.90 |   1491.69 | [1295.21, 1717.98]
#   -0.89 |   1566.71 | [1379.86, 1778.86]
#    0.12 |   1645.50 | [1441.35, 1878.56]
#    1.12 |   1728.25 | [1479.25, 2019.17]
```


```{r}
## Control models:
# square -----------------------------------------------------------------------
m1.sq <- lmer(log(RT) ~ sum.f.n + I(sum.f.n^2) + (1 + sum.f.n + I(sum.f.n^2)|subject) + (1|item), data = filter(d, group.cod == group_num), REML = FALSE)
summary(m1.sq)

# cubic ------------------------------------------------------------------------
# m1.cu <- lmer(log(RT) ~ sum.f.n + I(sum.f.n^2) + I(sum.f.n^3) + (1 + sum.f.n + I(sum.f.n^2) + I(sum.f.n^3)|subject) + (1|item), data = filter(d, group.cod == group_num), REML = FALSE)
# summary(m1.cu)

m1.cu <- lmer(log(RT) ~ sum.f.n + I(sum.f.n^2) + I(sum.f.n^3) + (1 + sum.f.n + I(sum.f.n^2)|subject) + (1|item), data = filter(d, group.cod == group_num), REML = FALSE)
# este converge pero nada significativo
summary(m1.cu)

## Alternative predictors ------------------------------------------------------
m1.e1 <- lmer(log(RT) ~ pre.min.n +            (1 + pre.min.n|subject) +            (1|item), data = filter(d, group.cod == group_num), REML = FALSE)
m1.e2 <- lmer(log(RT) ~ pre.max.n +            (1 + pre.max.n|subject) +            (1|item), data = filter(d, group.cod == group_num), REML = FALSE)
m1.e3 <- lmer(log(RT) ~ pre.product.n +        (1 + pre.product.n|subject) +        (1|item), data = filter(d, group.cod == group_num), REML = FALSE)
m1.e4 <- lmer(log(RT) ~ pre.sum_squared.n +    (1 + pre.sum_squared.n|subject) +    (1|item), data = filter(d, group.cod == group_num), REML = FALSE)
m1.e5 <- lmer(log(RT) ~ pre.sup_op_squared.n + (1 + pre.sup_op_squared.n|subject) + (1|item), data = filter(d, group.cod == group_num), REML = FALSE)
m1.e6 <- lmer(log(RT) ~ op.1.n +               (1 + op.1.n|subject) +               (1|item), data = filter(d, group.cod == group_num), REML = FALSE) #singular
m1.e7 <- lmer(log(RT) ~ op.2.n +               (1 + op.2.n|subject) +               (1|item), data = filter(d, group.cod == group_num), REML = FALSE) #singular

aov_table <- anova(m1,
             m1.e1, 
             m1.e2, 
             m1.e3, 
             m1.e4, 
             m1.e5,
             m1.e6,
             m1.e7
             )
```

# Change the names for each table ----------------------------------------------
```{r}
group_name = "grade 6"                                                          # grade 1 or grade 6
problem_type = "non-tie"                                                        # non-tie or tie
problem_size = "medium small"                                                   # very small, medium small, large, small
```

# TABLE 1: Models and control models -------------------------------------------
```{r}
table.1 <- matrix(NA, nrow = 8, ncol = 13)
colnames(table.1) <- c("age_group",
                        "problem_type",
                        "problem_size",
                        "VI",
                        "intercept estimate [log]",
                        "VI estimate [log]",
                        "SE",
                        "df",
                        "t.val",
                        "p.val",
                        "AIC",
                        "BIC",
                       "note")

table.1[,4] <- c("Sum", "Min(op.1|op.2)", "Max(op.1|op.2)", "product ~ (op.1*op.2)", "sum_sq ~ (op.1+op.2)^2", "sum_sq_op ~ op.1^2+op.2^2", "op.1", "op.2")

table.1[,1] <- group_name
table.1[,2] <- problem_type
table.1[,3] <- problem_size

View(table.1)

table.1[1,5] <- round(summary(m1)$coef[1,1], 2)
table.1[1,6] <- round(summary(m1)$coef[2,1], 2)
table.1[1,7] <- round(summary(m1)$coef[2,2], 2)
table.1[1,8] <- round(summary(m1)$coef[2,3], 2)
table.1[1,9] <- round(summary(m1)$coef[2,4], 2)
table.1[1,10]<- round(summary(m1)$coef[2,5], 5)
#------------------------------------------------------------------------------ Min
table.1[2,5] <- round(summary(m1.e1)$coef[1,1], 2)
table.1[2,6] <- round(summary(m1.e1)$coef[2,1], 2)
table.1[2,7] <- round(summary(m1.e1)$coef[2,2], 2)
table.1[2,8] <- round(summary(m1.e1)$coef[2,3], 2)
table.1[2,9] <- round(summary(m1.e1)$coef[2,4], 2)
table.1[2,10]<- round(summary(m1.e1)$coef[2,5], 5)
#-------------------------------.---------------------------------- Max
table.1[3,5] <- round(summary(m1.e2)$coef[1,1], 2)
table.1[3,6] <- round(summary(m1.e2)$coef[2,1], 2)
table.1[3,7] <- round(summary(m1.e2)$coef[2,2], 2)
table.1[3,8] <- round(summary(m1.e2)$coef[2,3], 2)
table.1[3,9] <- round(summary(m1.e2)$coef[2,4], 2)
table.1[3,10]<- round(summary(m1.e2)$coef[2,5], 5)
#-------------------------------.---------------------------------- product
table.1[4,5] <- round(summary(m1.e3)$coef[1,1], 2)
table.1[4,6] <- round(summary(m1.e3)$coef[2,1], 2)
table.1[4,7] <- round(summary(m1.e3)$coef[2,2], 2)
table.1[4,8] <- round(summary(m1.e3)$coef[2,3], 2)
table.1[4,9] <- round(summary(m1.e3)$coef[2,4], 2)
table.1[4,10]<- round(summary(m1.e3)$coef[2,5], 5)
#-------------------------------.---------------------------------- sum_sq
table.1[5,5] <- round(summary(m1.e4)$coef[1,1], 2)
table.1[5,6] <- round(summary(m1.e4)$coef[2,1], 2)
table.1[5,7] <- round(summary(m1.e4)$coef[2,2], 2)
table.1[5,8] <- round(summary(m1.e4)$coef[2,3], 2)
table.1[5,9] <- round(summary(m1.e4)$coef[2,4], 2)
table.1[5,10]<- round(summary(m1.e4)$coef[2,5], 5)
#-------------------------------.---------------------------------- sum_sq_op
table.1[6,5] <- round(summary(m1.e5)$coef[1,1], 2)
table.1[6,6] <- round(summary(m1.e5)$coef[2,1], 2)
table.1[6,7] <- round(summary(m1.e5)$coef[2,2], 2)
table.1[6,8] <- round(summary(m1.e5)$coef[2,3], 2)
table.1[6,9] <- round(summary(m1.e5)$coef[2,4], 2)
table.1[6,10]<- round(summary(m1.e5)$coef[2,5], 5)
#-------------------------------.---------------------------------- op.1
table.1[7,5] <- round(summary(m1.e6)$coef[1,1], 2)
table.1[7,6] <- round(summary(m1.e6)$coef[2,1], 2)
table.1[7,7] <- round(summary(m1.e6)$coef[2,2], 2)
table.1[7,8] <- round(summary(m1.e6)$coef[2,3], 2)
table.1[7,9] <- round(summary(m1.e6)$coef[2,4], 2)
table.1[7,10]<- round(summary(m1.e6)$coef[2,5], 5)
#-------------------------------.---------------------------------- op.2
table.1[8,5] <- round(summary(m1.e7)$coef[1,1], 2)
table.1[8,6] <- round(summary(m1.e7)$coef[2,1], 2)
table.1[8,7] <- round(summary(m1.e7)$coef[2,2], 2)
table.1[8,8] <- round(summary(m1.e7)$coef[2,3], 2)
table.1[8,9] <- round(summary(m1.e7)$coef[2,4], 2)
table.1[8,10]<- round(summary(m1.e7)$coef[2,5], 5)

table.1[,11]  <- round(aov_table[,2], 2)
table.1[,12]  <- round(aov_table[,3], 2)

# table.1[1,13] <- "singular"                                                     # m1
# table.1[2,13] <- "singular"                                                     # m1.e1
# table.1[3,13] <- "singular"                                                     # m1.e2
# table.1[4,13] <- "singular"                                                     # m1.e3
# table.1[5,13] <- "singular"                                                     # m1.e4
# table.1[6,13] <- "singular"                                                     # m1.e5
table.1[7,13] <- "singular"                                                     # m1.e6
table.1[8,13] <- "singular"                                                     # m1.e7

View(table.1)
```

# CHANGE THE NAME HERE:
```{r}
table_mS.G6 <- table.1 %>% as.tibble()
write.csv(table_mS.G6, "table_mS.G6.csv")
```

# TABLE 2: higher order polynomials --------------------------------------------
```{r}
table.2 <- matrix(NA, nrow = 6, ncol = 12) 

colnames(table.2) <- c("age_group",
                        "problem_type",
                        "problem_size",
                        "model",
                        "VI",
                        "intercept estimate [log]",
                        "VI estimate [log]",
                        "SE",
                        "df",
                        "t.val",
                        "p.val",
                         "note")

table.2[,4] <- c("lineal", "cuadratic", "cuadratic", "cubic", "cubic", "cubic")
table.2[,5] <- c("Sum", "Sum", "Sum^2", "Sum", "Sum^2", "Sum^3")

table.2[,1] <- group_name
table.2[,2] <- problem_type
table.2[,3] <- problem_size

View(table.2)

# linear
table.2[1,6]  <- round(summary(m1)$coef[1,1], 2)                                # intercept estimate
table.2[1,7]  <- round(summary(m1)$coef[2,1], 2)                                # VI estimate
table.2[1,8]  <- round(summary(m1)$coef[2,2], 2)                                # SE
table.2[1,9]  <- round(summary(m1)$coef[2,3], 2)                                # df
table.2[1,10] <- round(summary(m1)$coef[2,4], 2)                                # t.val
table.2[1,11] <- round(summary(m1)$coef[2,5], 5)                                # p.val
# cuadratic --------------------------------------------------------
table.2[2,6]  <- round(summary(m1.sq)$coef[1,1], 2)                             # intercept estimate
table.2[2,7]  <- round(summary(m1.sq)$coef[2,1], 2)                             # VI estimate
table.2[2,8]  <- round(summary(m1.sq)$coef[2,2], 2)                             # SE
table.2[2,9]  <- round(summary(m1.sq)$coef[2,3], 2)                             # df
table.2[2,10] <- round(summary(m1.sq)$coef[2,4], 2)                             # t.val
table.2[2,11] <- round(summary(m1.sq)$coef[2,5], 5)                             # p.val
# ----------------------------------------------------------------
table.2[3,6]  <- round(summary(m1.sq)$coef[1,1], 2)                             # intercept estimate
table.2[3,7]  <- round(summary(m1.sq)$coef[3,1], 2)                             # VI estimate
table.2[3,8]  <- round(summary(m1.sq)$coef[3,2], 2)                             # SE
table.2[3,9]  <- round(summary(m1.sq)$coef[3,3], 2)                             # df
table.2[3,10] <- round(summary(m1.sq)$coef[3,4], 2)                             # t.val
table.2[3,11] <- round(summary(m1.sq)$coef[3,5], 5)                             # p.val
# cubic ---------------------------------------------------------
table.2[4,6]  <- round(summary(m1.cu)$coef[1,1], 2)                             # intercept estimate
table.2[4,7]  <- round(summary(m1.cu)$coef[2,1], 2)                             # VI estimate
table.2[4,8]  <- round(summary(m1.cu)$coef[2,2], 2)                             # SE
table.2[4,9]  <- round(summary(m1.cu)$coef[2,3], 2)                             # df
table.2[4,10] <- round(summary(m1.cu)$coef[2,4], 2)                             # t.val
table.2[4,11] <- round(summary(m1.cu)$coef[2,5], 5)                             # p.val
# ----------------------------------------------------------------
table.2[5,6]  <- round(summary(m1.cu)$coef[1,1], 2)                             # intercept estimate
table.2[5,7]  <- round(summary(m1.cu)$coef[3,1], 2)                             # VI estimate
table.2[5,8]  <- round(summary(m1.cu)$coef[3,2], 2)                             # SE
table.2[5,9]  <- round(summary(m1.cu)$coef[3,3], 2)                             # df
table.2[5,10] <- round(summary(m1.cu)$coef[3,4], 2)                             # t.val
table.2[5,11] <- round(summary(m1.cu)$coef[3,5], 5)                             # p.val
# ----------------------------------------------------------------
table.2[6,6]  <- round(summary(m1.cu)$coef[1,1], 2)                             # intercept estimate
table.2[6,7]  <- round(summary(m1.cu)$coef[4,1], 2)                             # VI estimate
table.2[6,8]  <- round(summary(m1.cu)$coef[4,2], 2)                             # SE
table.2[6,9]  <- round(summary(m1.cu)$coef[4,3], 2)                             # df
table.2[6,10] <- round(summary(m1.cu)$coef[4,4], 2)                             # t.val
table.2[6,11] <- round(summary(m1.cu)$coef[4,5], 5)                             # p.val

View(table.2)
```

# CHANGE THE NAMES HERE --------------------------------------------------------
```{r}
table_mS.G6.poly <- table.2 %>% as.tibble
write.csv(table_mS.G6.poly, "table_mS.G6.poly.csv")
```

# remove the objects
```{r}
rm(group_name, group_num, problem_size, problem_type, m1, pre.m1, m1.e1, m1.e2, m1.e3, m1.e4, m1.e5, m1.e6, m1.e7, m1.sq, m1.cu, aov_table, table.1, table.2)
```


# Large non-ties ---------------------------------------------------------------
```{r}
d <- d.outliers_without %>% 
  filter(n.tie_large == 1)

d$sum.f.n <- scale(as.numeric(d$sum.f))
hist(d$sum.f.n, breaks = 20)

xtabs(~ sum.f + group.cod, data = d)

# Alternative predictors -------------------------------------------------------

d$pre.min.n            <- scale(as.numeric(d$pre.min)           , center = TRUE, scale = TRUE) # min
d$pre.max.n            <- scale(as.numeric(d$pre.max)           , center = TRUE, scale = TRUE) # max
d$pre.product.n        <- scale(as.numeric(d$pre.product)       , center = TRUE, scale = TRUE) # product (op.1*op.2)
d$pre.sum_squared.n    <- scale(as.numeric(d$pre.sum_squared)   , center = TRUE, scale = TRUE) # sum_squared ((op.1 + op.2)^2)
d$pre.sup_op_squared.n <- scale(as.numeric(d$pre.sum_op_squared), center = TRUE, scale = TRUE) # sum of squared operands (op.1^2 + op.2^2)
d$op.1.n               <- scale(as.numeric(d$op.1)              , center = TRUE, scale = TRUE) # op.1
d$op.2.n               <- scale(as.numeric(d$op.2)              , center = TRUE, scale = TRUE) # op.2

hist(d$pre.min.n,            breaks = 10)
hist(d$pre.max.n,            breaks = 10)
hist(d$pre.product.n ,       breaks = 10)
hist(d$pre.sum_squared.n,    breaks = 10)
hist(d$pre.sup_op_squared.n, breaks = 10)
hist(d$op.1.n,               breaks = 10)
hist(d$op.2.n,               breaks = 10)
```


```{r}
# SPECIFY THE GROUP
group_num = -0.5                                                                 # -0.5 ~ grade 1; 0.5 ~ grade 6

# Grade 1 ----------------------------------------------------------------------
m1 <- lmer(log(RT) ~ sum.f.n + (1 + sum.f.n|subject) + (1|item), data = filter(d, group.cod == group_num), REML = FALSE)
summary(m1)

performance::check_model(m1)

# predictions ------------------------------------------------------------------

pre.m1 <- ggpredict(m1, terms = "sum.f.n", se = TRUE, back.transform = FALSE)
pre.m1
plot(pre.m1)

# sum.f.n | Predicted |       95% CI
# ----------------------------------
#   -1.12 |      8.72 | [8.57, 8.88]
#   -0.57 |      8.80 | [8.66, 8.94]
#   -0.01 |      8.87 | [8.74, 9.01]
#    0.54 |      8.95 | [8.80, 9.09]
#    1.10 |      9.02 | [8.86, 9.18]
#    1.65 |      9.10 | [8.92, 9.28]
#    2.21 |      9.17 | [8.96, 9.38]
```


```{r}
## Control models:
# square -----------------------------------------------------------------------
m1.sq <- lmer(log(RT) ~ sum.f.n + I(sum.f.n^2) + (1 + sum.f.n + I(sum.f.n^2)|subject) + (1|item), data = filter(d, group.cod == group_num), REML = FALSE)
summary(m1.sq)

# cubic ------------------------------------------------------------------------
# m1.cu <- lmer(log(RT) ~ sum.f.n + I(sum.f.n^2) + I(sum.f.n^3) + (1 + sum.f.n + I(sum.f.n^2) + I(sum.f.n^3)|subject) + (1|item), data = filter(d, group.cod == group_num), REML = FALSE)
# # singular
# summary(m1.cu)

m1.cu <- lmer(log(RT) ~ sum.f.n + I(sum.f.n^2) + I(sum.f.n^3) + (1 + sum.f.n + I(sum.f.n^2)|subject) + (1|item), data = filter(d, group.cod == group_num), REML = FALSE)
summary(m1.cu)

## Alternative predictors ------------------------------------------------------
m1.e1 <- lmer(log(RT) ~ pre.min.n +            (1 + pre.min.n|subject) +            (1|item), data = filter(d, group.cod == group_num), REML = FALSE)
m1.e2 <- lmer(log(RT) ~ pre.max.n +            (1 + pre.max.n|subject) +            (1|item), data = filter(d, group.cod == group_num), REML = FALSE)
m1.e3 <- lmer(log(RT) ~ pre.product.n +        (1 + pre.product.n|subject) +        (1|item), data = filter(d, group.cod == group_num), REML = FALSE)
m1.e4 <- lmer(log(RT) ~ pre.sum_squared.n +    (1 + pre.sum_squared.n|subject) +    (1|item), data = filter(d, group.cod == group_num), REML = FALSE)
m1.e5 <- lmer(log(RT) ~ pre.sup_op_squared.n + (1 + pre.sup_op_squared.n|subject) + (1|item), data = filter(d, group.cod == group_num), REML = FALSE)
m1.e6 <- lmer(log(RT) ~ op.1.n +               (1 + op.1.n|subject) +               (1|item), data = filter(d, group.cod == group_num), REML = FALSE) #singular
m1.e7 <- lmer(log(RT) ~ op.2.n +               (1 + op.2.n|subject) +               (1|item), data = filter(d, group.cod == group_num), REML = FALSE)

aov_table <- anova(m1,
                   m1.e1, 
                   m1.e2, 
                   m1.e3, 
                   m1.e4, 
                   m1.e5,
                   m1.e6,
                   m1.e7
                   )
```

# Change the names for each table ----------------------------------------------
```{r}
group_name = "grade 1"                                                          # grade 1 or grade 6
problem_type = "non-tie"                                                        # non-tie or tie
problem_size = "large"                                                          # very small, medium small, large, small
```

# TABLE 1: Models and control models -------------------------------------------
```{r}
table.1 <- matrix(NA, nrow = 8, ncol = 13)
colnames(table.1) <- c("age_group",
                        "problem_type",
                        "problem_size",
                        "VI",
                        "intercept estimate [log]",
                        "VI estimate [log]",
                        "SE",
                        "df",
                        "t.val",
                        "p.val",
                        "AIC",
                        "BIC",
                       "note")

table.1[,4] <- c("Sum", "Min(op.1|op.2)", "Max(op.1|op.2)", "product ~ (op.1*op.2)", "sum_sq ~ (op.1+op.2)^2", "sum_sq_op ~ op.1^2+op.2^2", "op.1", "op.2")

table.1[,1] <- group_name
table.1[,2] <- problem_type
table.1[,3] <- problem_size

View(table.1)

table.1[1,5] <- round(summary(m1)$coef[1,1], 2)
table.1[1,6] <- round(summary(m1)$coef[2,1], 2)
table.1[1,7] <- round(summary(m1)$coef[2,2], 2)
table.1[1,8] <- round(summary(m1)$coef[2,3], 2)
table.1[1,9] <- round(summary(m1)$coef[2,4], 2)
table.1[1,10]<- round(summary(m1)$coef[2,5], 5)
#------------------------------------------------------------------------------ Min
table.1[2,5] <- round(summary(m1.e1)$coef[1,1], 2)
table.1[2,6] <- round(summary(m1.e1)$coef[2,1], 2)
table.1[2,7] <- round(summary(m1.e1)$coef[2,2], 2)
table.1[2,8] <- round(summary(m1.e1)$coef[2,3], 2)
table.1[2,9] <- round(summary(m1.e1)$coef[2,4], 2)
table.1[2,10]<- round(summary(m1.e1)$coef[2,5], 5)
#-------------------------------.---------------------------------- Max
table.1[3,5] <- round(summary(m1.e2)$coef[1,1], 2)
table.1[3,6] <- round(summary(m1.e2)$coef[2,1], 2)
table.1[3,7] <- round(summary(m1.e2)$coef[2,2], 2)
table.1[3,8] <- round(summary(m1.e2)$coef[2,3], 2)
table.1[3,9] <- round(summary(m1.e2)$coef[2,4], 2)
table.1[3,10]<- round(summary(m1.e2)$coef[2,5], 5)
#-------------------------------.---------------------------------- product
table.1[4,5] <- round(summary(m1.e3)$coef[1,1], 2)
table.1[4,6] <- round(summary(m1.e3)$coef[2,1], 2)
table.1[4,7] <- round(summary(m1.e3)$coef[2,2], 2)
table.1[4,8] <- round(summary(m1.e3)$coef[2,3], 2)
table.1[4,9] <- round(summary(m1.e3)$coef[2,4], 2)
table.1[4,10]<- round(summary(m1.e3)$coef[2,5], 5)
#-------------------------------.---------------------------------- sum_sq
table.1[5,5] <- round(summary(m1.e4)$coef[1,1], 2)
table.1[5,6] <- round(summary(m1.e4)$coef[2,1], 2)
table.1[5,7] <- round(summary(m1.e4)$coef[2,2], 2)
table.1[5,8] <- round(summary(m1.e4)$coef[2,3], 2)
table.1[5,9] <- round(summary(m1.e4)$coef[2,4], 2)
table.1[5,10]<- round(summary(m1.e4)$coef[2,5], 5)
#-------------------------------.---------------------------------- sum_sq_op
table.1[6,5] <- round(summary(m1.e5)$coef[1,1], 2)
table.1[6,6] <- round(summary(m1.e5)$coef[2,1], 2)
table.1[6,7] <- round(summary(m1.e5)$coef[2,2], 2)
table.1[6,8] <- round(summary(m1.e5)$coef[2,3], 2)
table.1[6,9] <- round(summary(m1.e5)$coef[2,4], 2)
table.1[6,10]<- round(summary(m1.e5)$coef[2,5], 5)
#-------------------------------.---------------------------------- op.1
table.1[7,5] <- round(summary(m1.e6)$coef[1,1], 2)
table.1[7,6] <- round(summary(m1.e6)$coef[2,1], 2)
table.1[7,7] <- round(summary(m1.e6)$coef[2,2], 2)
table.1[7,8] <- round(summary(m1.e6)$coef[2,3], 2)
table.1[7,9] <- round(summary(m1.e6)$coef[2,4], 2)
table.1[7,10]<- round(summary(m1.e6)$coef[2,5], 5)
#-------------------------------.---------------------------------- op.2
table.1[8,5] <- round(summary(m1.e7)$coef[1,1], 2)
table.1[8,6] <- round(summary(m1.e7)$coef[2,1], 2)
table.1[8,7] <- round(summary(m1.e7)$coef[2,2], 2)
table.1[8,8] <- round(summary(m1.e7)$coef[2,3], 2)
table.1[8,9] <- round(summary(m1.e7)$coef[2,4], 2)
table.1[8,10]<- round(summary(m1.e7)$coef[2,5], 5)

table.1[,11]  <- round(aov_table[,2], 2)
table.1[,12]  <- round(aov_table[,3], 2)

# table.1[1,13] <- "singular"                                                     # m1
# table.1[2,13] <- "singular"                                                     # m1.e1
# table.1[3,13] <- "singular"                                                     # m1.e2
# table.1[4,13] <- "singular"                                                     # m1.e3
# table.1[5,13] <- "singular"                                                     # m1.e4
# table.1[6,13] <- "singular"                                                     # m1.e5
table.1[7,13] <- "singular"                                                     # m1.e6
# table.1[8,13] <- "singular"                                                     # m1.e7

View(table.1)
```

# CHANGE THE NAME HERE:
```{r}
table_L.G1 <- table.1 %>% as.tibble()
write.csv(table_L.G1, "table_L.G1.csv")
```

# TABLE 2: higher order polynomials --------------------------------------------
```{r}
table.2 <- matrix(NA, nrow = 6, ncol = 12) 

colnames(table.2) <- c("age_group",
                        "problem_type",
                        "problem_size",
                        "model",
                        "VI",
                        "intercept estimate [log]",
                        "VI estimate [log]",
                        "SE",
                        "df",
                        "t.val",
                        "p.val",
                         "note")

table.2[,4] <- c("lineal", "cuadratic", "cuadratic", "cubic", "cubic", "cubic")
table.2[,5] <- c("Sum", "Sum", "Sum^2", "Sum", "Sum^2", "Sum^3")

table.2[,1] <- group_name
table.2[,2] <- problem_type
table.2[,3] <- problem_size

View(table.2)

# linear
table.2[1,6]  <- round(summary(m1)$coef[1,1], 2)                                # intercept estimate
table.2[1,7]  <- round(summary(m1)$coef[2,1], 2)                                # VI estimate
table.2[1,8]  <- round(summary(m1)$coef[2,2], 2)                                # SE
table.2[1,9]  <- round(summary(m1)$coef[2,3], 2)                                # df
table.2[1,10] <- round(summary(m1)$coef[2,4], 2)                                # t.val
table.2[1,11] <- round(summary(m1)$coef[2,5], 5)                                # p.val
# cuadratic --------------------------------------------------------
table.2[2,6]  <- round(summary(m1.sq)$coef[1,1], 2)                             # intercept estimate
table.2[2,7]  <- round(summary(m1.sq)$coef[2,1], 2)                             # VI estimate
table.2[2,8]  <- round(summary(m1.sq)$coef[2,2], 2)                             # SE
table.2[2,9]  <- round(summary(m1.sq)$coef[2,3], 2)                             # df
table.2[2,10] <- round(summary(m1.sq)$coef[2,4], 2)                             # t.val
table.2[2,11] <- round(summary(m1.sq)$coef[2,5], 5)                             # p.val
# ----------------------------------------------------------------
table.2[3,6]  <- round(summary(m1.sq)$coef[1,1], 2)                             # intercept estimate
table.2[3,7]  <- round(summary(m1.sq)$coef[3,1], 2)                             # VI estimate
table.2[3,8]  <- round(summary(m1.sq)$coef[3,2], 2)                             # SE
table.2[3,9]  <- round(summary(m1.sq)$coef[3,3], 2)                             # df
table.2[3,10] <- round(summary(m1.sq)$coef[3,4], 2)                             # t.val
table.2[3,11] <- round(summary(m1.sq)$coef[3,5], 5)                             # p.val
# cubic ---------------------------------------------------------
table.2[4,6]  <- round(summary(m1.cu)$coef[1,1], 2)                             # intercept estimate
table.2[4,7]  <- round(summary(m1.cu)$coef[2,1], 2)                             # VI estimate
table.2[4,8]  <- round(summary(m1.cu)$coef[2,2], 2)                             # SE
table.2[4,9]  <- round(summary(m1.cu)$coef[2,3], 2)                             # df
table.2[4,10] <- round(summary(m1.cu)$coef[2,4], 2)                             # t.val
table.2[4,11] <- round(summary(m1.cu)$coef[2,5], 5)                             # p.val
# ----------------------------------------------------------------
table.2[5,6]  <- round(summary(m1.cu)$coef[1,1], 2)                             # intercept estimate
table.2[5,7]  <- round(summary(m1.cu)$coef[3,1], 2)                             # VI estimate
table.2[5,8]  <- round(summary(m1.cu)$coef[3,2], 2)                             # SE
table.2[5,9]  <- round(summary(m1.cu)$coef[3,3], 2)                             # df
table.2[5,10] <- round(summary(m1.cu)$coef[3,4], 2)                             # t.val
table.2[5,11] <- round(summary(m1.cu)$coef[3,5], 5)                             # p.val
# ----------------------------------------------------------------
table.2[6,6]  <- round(summary(m1.cu)$coef[1,1], 2)                             # intercept estimate
table.2[6,7]  <- round(summary(m1.cu)$coef[4,1], 2)                             # VI estimate
table.2[6,8]  <- round(summary(m1.cu)$coef[4,2], 2)                             # SE
table.2[6,9]  <- round(summary(m1.cu)$coef[4,3], 2)                             # df
table.2[6,10] <- round(summary(m1.cu)$coef[4,4], 2)                             # t.val
table.2[6,11] <- round(summary(m1.cu)$coef[4,5], 5)                             # p.val

View(table.2)
```

# CHANGE THE NAMES HERE --------------------------------------------------------
```{r}
table_L.G1.poly <- table.2 %>% as.tibble
write.csv(table_L.G1.poly, "table_L.G1.poly.csv")
```

# remove the objects
```{r}
rm(group_name, group_num, problem_size, problem_type, m1, pre.m1, m1.e1, m1.e2, m1.e3, m1.e4, m1.e5, m1.e6, m1.e7, m1.sq, m1.cu, aov_table, table.1, table.2)
```

```{r}
# SPECIFY THE GROUP
group_num = 0.5                                                                 # -0.5 ~ grade 1; 0.5 ~ grade 6

# Grade 6 ----------------------------------------------------------------------
m1  <- lmer(log(RT) ~ sum.f.n + (1 + sum.f.n|subject) + (1|item), data = filter(d, group.cod == group_num), REML = FALSE)
summary(m1)

performance::check_model(m1)

# predictions ------------------------------------------------------------------

# pre.m1 <- ggpredict(m1, terms = "sum.f.n", se = TRUE, back.transform = FALSE)
# pre.m1
# plot(pre.m1)
# 
# # sum.f.n | Predicted |       95% CI
# # ----------------------------------
# #   -1.12 |      7.72 | [7.59, 7.86]
# #   -0.57 |      7.77 | [7.64, 7.90]
# #   -0.01 |      7.82 | [7.69, 7.95]
# #    0.54 |      7.87 | [7.73, 8.01]
# #    1.10 |      7.92 | [7.77, 8.07]
# #    1.65 |      7.97 | [7.80, 8.14]
# #    2.21 |      8.02 | [7.83, 8.21]

## Control models:
# square -----------------------------------------------------------------------
m1.sq <- lmer(log(RT) ~ sum.f.n + I(sum.f.n^2) + (1 + sum.f.n + I(sum.f.n^2)|subject) + (1|item), data = filter(d, group.cod == group_num), REML = FALSE)
summary(m1.sq)

# m1.sq <- afex::mixed(log(RT) ~ sum.f.n + I(sum.f.n^2) + (1 + sum.f.n + I(sum.f.n^2)|subject) + (1|item), data = filter(d, group.cod == group_num), method = "LRT")
# m1.sq

# cubic ------------------------------------------------------------------------
# m1.cu <- lmer(log(RT) ~ sum.f.n + I(sum.f.n^2) + I(sum.f.n^3) + (1 + sum.f.n + I(sum.f.n^2) + I(sum.f.n^3)|subject) + (1|item), data = filter(d, group.cod == group_num), REML = FALSE)
# summary(m1.cu)
# # failed to converge

m1.cu <- lmer(log(RT) ~ sum.f.n + I(sum.f.n^2) + I(sum.f.n^3) + (1 + sum.f.n + I(sum.f.n^2)|subject) + (1|item), data = filter(d, group.cod == group_num), REML = FALSE)
summary(m1.cu)


# predictions with the quadratic term included ---------------------------------

pre.m1.sq <- ggpredict(m1.sq, terms = "sum.f.n[all]", se = TRUE, back.transform = FALSE)
pre.m1.sq
plot(pre.m1.sq)

# sum.f.n | Predicted |       95% CI
# ----------------------------------
#   -1.12 |      7.66 | [7.52, 7.80]
#   -0.57 |      7.79 | [7.66, 7.92]
#   -0.01 |      7.89 | [7.75, 8.03]
#    0.54 |      7.94 | [7.80, 8.09]
#    1.10 |      7.96 | [7.81, 8.11]
#    1.65 |      7.93 | [7.76, 8.09]
#    2.21 |      7.86 | [7.65, 8.07]
```


```{r}
## Alternative predictors ------------------------------------------------------
# m1.e1 <- lmer(log(RT) ~ pre.min.n +            (1 + pre.min.n|subject) +            (1|item), data = filter(d, group.cod == group_num), REML = FALSE)
# m1.e2 <- lmer(log(RT) ~ pre.max.n +            (1 + pre.max.n|subject) +            (1|item), data = filter(d, group.cod == group_num), REML = FALSE) # failed to converge
# m1.e3 <- lmer(log(RT) ~ pre.product.n +        (1 + pre.product.n|subject) +        (1|item), data = filter(d, group.cod == group_num), REML = FALSE)
# m1.e4 <- lmer(log(RT) ~ pre.sum_squared.n +    (1 + pre.sum_squared.n|subject) +    (1|item), data = filter(d, group.cod == group_num), REML = FALSE)
# m1.e5 <- lmer(log(RT) ~ pre.sup_op_squared.n + (1 + pre.sup_op_squared.n|subject) + (1|item), data = filter(d, group.cod == group_num), REML = FALSE) # failed to converge
# m1.e6 <- lmer(log(RT) ~ op.1.n +               (1 + op.1.n|subject) +               (1|item), data = filter(d, group.cod == group_num), REML = FALSE) # failed to converge
# m1.e7 <- lmer(log(RT) ~ op.2.n +               (1 + op.2.n|subject) +               (1|item), data = filter(d, group.cod == group_num), REML = FALSE) # failed to converge

m1.e1 <- lmer(log(RT) ~ pre.min.n +            I(pre.min.n^2)            + (1 + pre.min.n            + I(pre.min.n^2)           |subject) +    (1|item), data = filter(d, group.cod == group_num), REML = FALSE)
m1.e2 <- lmer(log(RT) ~ pre.max.n +            I(pre.max.n^2)            + (1 + pre.max.n            + I(pre.max.n^2)           |subject) +    (1|item), data = filter(d, group.cod == group_num), REML = FALSE)
m1.e3 <- lmer(log(RT) ~ pre.product.n +        I(pre.product.n^2)        + (1 + pre.product.n        + I(pre.product.n^2)       |subject) +    (1|item), data = filter(d, group.cod == group_num), REML = FALSE)
m1.e4 <- lmer(log(RT) ~ pre.sum_squared.n +    I(pre.sum_squared.n^2)    + (1 + pre.sum_squared.n    + I(pre.sum_squared.n^2)   |subject) +    (1|item), data = filter(d, group.cod == group_num), REML = FALSE)
m1.e5 <- lmer(log(RT) ~ pre.sup_op_squared.n + I(pre.sup_op_squared.n^2) + (1 + pre.sup_op_squared.n + I(pre.sup_op_squared.n^2)|subject) +    (1|item), data = filter(d, group.cod == group_num), REML = FALSE)
m1.e6 <- lmer(log(RT) ~ op.1.n +               I(op.1.n^2)               + (1 + op.1.n               + I(op.1.n^2)              |subject) +    (1|item), data = filter(d, group.cod == group_num), REML = FALSE)
m1.e7 <- lmer(log(RT) ~ op.2.n +               I(op.2.n^2)               + (1 + op.2.n               + I(op.2.n^2)              |subject) +    (1|item), data = filter(d, group.cod == group_num), REML = FALSE) #singular

summary(m1.e1)
summary(m1.e2)
summary(m1.e3)
summary(m1.e4)
summary(m1.e5)
summary(m1.e6)
summary(m1.e7)

aov_table <- anova(m1.sq,
                   m1.e1,
                   m1.e2, 
                   m1.e3, 
                   m1.e4, 
                   m1.e5,
                   m1.e6,
                   m1.e7
                   )
```

# Change the names for each table ----------------------------------------------
```{r}
group_name = "grade 6"                                                          # grade 1 or grade 6
problem_type = "non-tie"                                                        # non-tie or tie
problem_size = "large"                                                          # very small, medium small, large, small
```

# TABLE 1: Models and control models -------------------------------------------
```{r}
table.1 <- matrix(NA, nrow = 8, ncol = 13)
colnames(table.1) <- c("age_group",
                        "problem_type",
                        "problem_size",
                        "VI",
                        "intercept estimate [log]",
                        "VI estimate [log]",
                        "SE",
                        "df",
                        "t.val",
                        "p.val",
                        "AIC",
                        "BIC",
                       "note")

table.1[,4] <- c("Sum", "Min(op.1|op.2)", "Max(op.1|op.2)", "product ~ (op.1*op.2)", "sum_sq ~ (op.1+op.2)^2", "sum_sq_op ~ op.1^2+op.2^2", "op.1", "op.2")

table.1[,1] <- group_name
table.1[,2] <- problem_type
table.1[,3] <- problem_size

View(table.1)

table.1[1,5] <- round(summary(m1.sq)$coef[1,1], 2)
table.1[1,6] <- round(summary(m1.sq)$coef[2,1], 2)
table.1[1,7] <- round(summary(m1.sq)$coef[2,2], 2)
table.1[1,8] <- round(summary(m1.sq)$coef[2,3], 2)
table.1[1,9] <- round(summary(m1.sq)$coef[2,4], 2)
table.1[1,10]<- round(summary(m1.sq)$coef[2,5], 5)
#------------------------------------------------------------------------------ Min
table.1[2,5] <- round(summary(m1.e1)$coef[1,1], 2)
table.1[2,6] <- round(summary(m1.e1)$coef[2,1], 2)
table.1[2,7] <- round(summary(m1.e1)$coef[2,2], 2)
table.1[2,8] <- round(summary(m1.e1)$coef[2,3], 2)
table.1[2,9] <- round(summary(m1.e1)$coef[2,4], 2)
table.1[2,10]<- round(summary(m1.e1)$coef[2,5], 5)
#-------------------------------.---------------------------------- Max
table.1[3,5] <- round(summary(m1.e2)$coef[1,1], 2)
table.1[3,6] <- round(summary(m1.e2)$coef[2,1], 2)
table.1[3,7] <- round(summary(m1.e2)$coef[2,2], 2)
table.1[3,8] <- round(summary(m1.e2)$coef[2,3], 2)
table.1[3,9] <- round(summary(m1.e2)$coef[2,4], 2)
table.1[3,10]<- round(summary(m1.e2)$coef[2,5], 5)
#-------------------------------.---------------------------------- product
table.1[4,5] <- round(summary(m1.e3)$coef[1,1], 2)
table.1[4,6] <- round(summary(m1.e3)$coef[2,1], 2)
table.1[4,7] <- round(summary(m1.e3)$coef[2,2], 2)
table.1[4,8] <- round(summary(m1.e3)$coef[2,3], 2)
table.1[4,9] <- round(summary(m1.e3)$coef[2,4], 2)
table.1[4,10]<- round(summary(m1.e3)$coef[2,5], 5)
#-------------------------------.---------------------------------- sum_sq
table.1[5,5] <- round(summary(m1.e4)$coef[1,1], 2)
table.1[5,6] <- round(summary(m1.e4)$coef[2,1], 2)
table.1[5,7] <- round(summary(m1.e4)$coef[2,2], 2)
table.1[5,8] <- round(summary(m1.e4)$coef[2,3], 2)
table.1[5,9] <- round(summary(m1.e4)$coef[2,4], 2)
table.1[5,10]<- round(summary(m1.e4)$coef[2,5], 5)
#-------------------------------.---------------------------------- sum_sq_op
table.1[6,5] <- round(summary(m1.e5)$coef[1,1], 2)
table.1[6,6] <- round(summary(m1.e5)$coef[2,1], 2)
table.1[6,7] <- round(summary(m1.e5)$coef[2,2], 2)
table.1[6,8] <- round(summary(m1.e5)$coef[2,3], 2)
table.1[6,9] <- round(summary(m1.e5)$coef[2,4], 2)
table.1[6,10]<- round(summary(m1.e5)$coef[2,5], 5)
#-------------------------------.---------------------------------- op.1
table.1[7,5] <- round(summary(m1.e6)$coef[1,1], 2)
table.1[7,6] <- round(summary(m1.e6)$coef[2,1], 2)
table.1[7,7] <- round(summary(m1.e6)$coef[2,2], 2)
table.1[7,8] <- round(summary(m1.e6)$coef[2,3], 2)
table.1[7,9] <- round(summary(m1.e6)$coef[2,4], 2)
table.1[7,10]<- round(summary(m1.e6)$coef[2,5], 5)
#-------------------------------.---------------------------------- op.2
table.1[8,5] <- round(summary(m1.e7)$coef[1,1], 2)
table.1[8,6] <- round(summary(m1.e7)$coef[2,1], 2)
table.1[8,7] <- round(summary(m1.e7)$coef[2,2], 2)
table.1[8,8] <- round(summary(m1.e7)$coef[2,3], 2)
table.1[8,9] <- round(summary(m1.e7)$coef[2,4], 2)
table.1[8,10]<- round(summary(m1.e7)$coef[2,5], 5)

table.1[,11]  <- round(aov_table[,2], 2)
table.1[,12]  <- round(aov_table[,3], 2)

table.1[1,13] <- "linear term"                                                     # m1
table.1[2,13] <- "linear term"                                                     # m1.e1
table.1[3,13] <- "linear term"                                                     # m1.e2
table.1[4,13] <- "linear term"                                                     # m1.e3
table.1[5,13] <- "linear term"                                                     # m1.e4
table.1[6,13] <- "linear term"                                                     # m1.e5
table.1[7,13] <- "linear term"                                                     # m1.e6
table.1[8,13] <- "linear term; singular model"                                                     # m1.e7

View(table.1)
```

# CHANGE THE NAME HERE:
```{r}
table_L.G6_linear <- table.1 %>% as.tibble()
write.csv(table_L.G6_linear, "table_L.G6_linear.csv")
```

# TABLE 1: Models and control models -------------------------------------------
```{r}
table.1 <- matrix(NA, nrow = 8, ncol = 13)
colnames(table.1) <- c("age_group",
                        "problem_type",
                        "problem_size",
                        "VI",
                        "intercept estimate [log]",
                        "VI estimate [log]",
                        "SE",
                        "df",
                        "t.val",
                        "p.val",
                        "AIC",
                        "BIC",
                       "note")

table.1[,4] <- c("Sum", "Min(op.1|op.2)", "Max(op.1|op.2)", "product ~ (op.1*op.2)", "sum_sq ~ (op.1+op.2)^2", "sum_sq_op ~ op.1^2+op.2^2", "op.1", "op.2")

table.1[,1] <- group_name
table.1[,2] <- problem_type
table.1[,3] <- problem_size

View(table.1)

table.1[1,5] <- round(summary(m1.sq)$coef[1,1], 2)
table.1[1,6] <- round(summary(m1.sq)$coef[3,1], 2)
table.1[1,7] <- round(summary(m1.sq)$coef[3,2], 2)
table.1[1,8] <- round(summary(m1.sq)$coef[3,3], 2)
table.1[1,9] <- round(summary(m1.sq)$coef[3,4], 2)
table.1[1,10]<- round(summary(m1.sq)$coef[3,5], 5)
#------------------------------------------------------------------------------ Min
table.1[2,5] <- round(summary(m1.e1)$coef[1,1], 2)
table.1[2,6] <- round(summary(m1.e1)$coef[3,1], 2)
table.1[2,7] <- round(summary(m1.e1)$coef[3,2], 2)
table.1[2,8] <- round(summary(m1.e1)$coef[3,3], 2)
table.1[2,9] <- round(summary(m1.e1)$coef[3,4], 2)
table.1[2,10]<- round(summary(m1.e1)$coef[3,5], 5)
#-------------------------------.---------3------------------------ Max
table.1[3,5] <- round(summary(m1.e2)$coef[1,1], 2)
table.1[3,6] <- round(summary(m1.e2)$coef[3,1], 2)
table.1[3,7] <- round(summary(m1.e2)$coef[3,2], 2)
table.1[3,8] <- round(summary(m1.e2)$coef[3,3], 2)
table.1[3,9] <- round(summary(m1.e2)$coef[3,4], 2)
table.1[3,10]<- round(summary(m1.e2)$coef[3,5], 5)
#-------------------------------.---------3------------------------ product
table.1[4,5] <- round(summary(m1.e3)$coef[1,1], 2)
table.1[4,6] <- round(summary(m1.e3)$coef[3,1], 2)
table.1[4,7] <- round(summary(m1.e3)$coef[3,2], 2)
table.1[4,8] <- round(summary(m1.e3)$coef[3,3], 2)
table.1[4,9] <- round(summary(m1.e3)$coef[3,4], 2)
table.1[4,10]<- round(summary(m1.e3)$coef[3,5], 5)
#-------------------------------.---------3------------------------ sum_sq
table.1[5,5] <- round(summary(m1.e4)$coef[1,1], 2)
table.1[5,6] <- round(summary(m1.e4)$coef[3,1], 2)
table.1[5,7] <- round(summary(m1.e4)$coef[3,2], 2)
table.1[5,8] <- round(summary(m1.e4)$coef[3,3], 2)
table.1[5,9] <- round(summary(m1.e4)$coef[3,4], 2)
table.1[5,10]<- round(summary(m1.e4)$coef[3,5], 5)
#-------------------------------.---------3------------------------ sum_sq_op
table.1[6,5] <- round(summary(m1.e5)$coef[1,1], 2)
table.1[6,6] <- round(summary(m1.e5)$coef[3,1], 2)
table.1[6,7] <- round(summary(m1.e5)$coef[3,2], 2)
table.1[6,8] <- round(summary(m1.e5)$coef[3,3], 2)
table.1[6,9] <- round(summary(m1.e5)$coef[3,4], 2)
table.1[6,10]<- round(summary(m1.e5)$coef[3,5], 5)
#-------------------------------.---------3------------------------ op.1
table.1[7,5] <- round(summary(m1.e6)$coef[1,1], 2)
table.1[7,6] <- round(summary(m1.e6)$coef[3,1], 2)
table.1[7,7] <- round(summary(m1.e6)$coef[3,2], 2)
table.1[7,8] <- round(summary(m1.e6)$coef[3,3], 2)
table.1[7,9] <- round(summary(m1.e6)$coef[3,4], 2)
table.1[7,10]<- round(summary(m1.e6)$coef[3,5], 5)
#-------------------------------.---------3------------------------ op.2
table.1[8,5] <- round(summary(m1.e7)$coef[1,1], 2)
table.1[8,6] <- round(summary(m1.e7)$coef[3,1], 2)
table.1[8,7] <- round(summary(m1.e7)$coef[3,2], 2)
table.1[8,8] <- round(summary(m1.e7)$coef[3,3], 2)
table.1[8,9] <- round(summary(m1.e7)$coef[3,4], 2)
table.1[8,10]<- round(summary(m1.e7)$coef[3,5], 5)

table.1[,11]  <- round(aov_table[,2], 2)
table.1[,12]  <- round(aov_table[,3], 2)

table.1[1,13] <- "quadratic term"                                                     # m1
table.1[2,13] <- "quadratic term"                                                     # m1.e1
table.1[3,13] <- "quadratic term"                                                     # m1.e2
table.1[4,13] <- "quadratic term"                                                     # m1.e3
table.1[5,13] <- "quadratic term"                                                     # m1.e4
table.1[6,13] <- "quadratic term"                                                     # m1.e5
table.1[7,13] <- "quadratic term"                                                     # m1.e6
table.1[8,13] <- "quadratic term; singular model"                                                     # m1.e7

View(table.1)
```


# CHANGE THE NAME HERE:
```{r}
table_L.G6_quadratic <- table.1 %>% as.tibble()
write.csv(table_L.G6_quadratic, "table_L.G6_quadratic.csv")
```

# TABLE 2: higher order polynomials --------------------------------------------
```{r}
table.2 <- matrix(NA, nrow = 6, ncol = 12) 

colnames(table.2) <- c("age_group",
                        "problem_type",
                        "problem_size",
                        "model",
                        "VI",
                        "intercept estimate [log]",
                        "VI estimate [log]",
                        "SE",
                        "df",
                        "t.val",
                        "p.val",
                         "note")

table.2[,4] <- c("lineal", "cuadratic", "cuadratic", "cubic", "cubic", "cubic")
table.2[,5] <- c("Sum", "Sum", "Sum^2", "Sum", "Sum^2", "Sum^3")

table.2[,1] <- group_name
table.2[,2] <- problem_type
table.2[,3] <- problem_size

View(table.2)

# linear
table.2[1,6]  <- round(summary(m1)$coef[1,1], 2)                                # intercept estimate
table.2[1,7]  <- round(summary(m1)$coef[2,1], 2)                                # VI estimate
table.2[1,8]  <- round(summary(m1)$coef[2,2], 2)                                # SE
table.2[1,9]  <- round(summary(m1)$coef[2,3], 2)                                # df
table.2[1,10] <- round(summary(m1)$coef[2,4], 2)                                # t.val
table.2[1,11] <- round(summary(m1)$coef[2,5], 5)                                # p.val
# cuadratic --------------------------------------------------------
table.2[2,6]  <- round(summary(m1.sq)$coef[1,1], 2)                             # intercept estimate
table.2[2,7]  <- round(summary(m1.sq)$coef[2,1], 2)                             # VI estimate
table.2[2,8]  <- round(summary(m1.sq)$coef[2,2], 2)                             # SE
table.2[2,9]  <- round(summary(m1.sq)$coef[2,3], 2)                             # df
table.2[2,10] <- round(summary(m1.sq)$coef[2,4], 2)                             # t.val
table.2[2,11] <- round(summary(m1.sq)$coef[2,5], 5)                             # p.val
# ----------------------------------------------------------------
table.2[3,6]  <- round(summary(m1.sq)$coef[1,1], 2)                             # intercept estimate
table.2[3,7]  <- round(summary(m1.sq)$coef[3,1], 2)                             # VI estimate
table.2[3,8]  <- round(summary(m1.sq)$coef[3,2], 2)                             # SE
table.2[3,9]  <- round(summary(m1.sq)$coef[3,3], 2)                             # df
table.2[3,10] <- round(summary(m1.sq)$coef[3,4], 2)                             # t.val
table.2[3,11] <- round(summary(m1.sq)$coef[3,5], 5)                             # p.val
# cubic ---------------------------------------------------------
table.2[4,6]  <- round(summary(m1.cu)$coef[1,1], 2)                             # intercept estimate
table.2[4,7]  <- round(summary(m1.cu)$coef[2,1], 2)                             # VI estimate
table.2[4,8]  <- round(summary(m1.cu)$coef[2,2], 2)                             # SE
table.2[4,9]  <- round(summary(m1.cu)$coef[2,3], 2)                             # df
table.2[4,10] <- round(summary(m1.cu)$coef[2,4], 2)                             # t.val
table.2[4,11] <- round(summary(m1.cu)$coef[2,5], 5)                             # p.val
# ----------------------------------------------------------------
table.2[5,6]  <- round(summary(m1.cu)$coef[1,1], 2)                             # intercept estimate
table.2[5,7]  <- round(summary(m1.cu)$coef[3,1], 2)                             # VI estimate
table.2[5,8]  <- round(summary(m1.cu)$coef[3,2], 2)                             # SE
table.2[5,9]  <- round(summary(m1.cu)$coef[3,3], 2)                             # df
table.2[5,10] <- round(summary(m1.cu)$coef[3,4], 2)                             # t.val
table.2[5,11] <- round(summary(m1.cu)$coef[3,5], 5)                             # p.val
# ----------------------------------------------------------------
table.2[6,6]  <- round(summary(m1.cu)$coef[1,1], 2)                             # intercept estimate
table.2[6,7]  <- round(summary(m1.cu)$coef[4,1], 2)                             # VI estimate
table.2[6,8]  <- round(summary(m1.cu)$coef[4,2], 2)                             # SE
table.2[6,9]  <- round(summary(m1.cu)$coef[4,3], 2)                             # df
table.2[6,10] <- round(summary(m1.cu)$coef[4,4], 2)                             # t.val
table.2[6,11] <- round(summary(m1.cu)$coef[4,5], 5)                             # p.val

View(table.2)
```

# CHANGE THE NAMES HERE --------------------------------------------------------
```{r}
table_L.G6.poly <- table.2 %>% as.tibble
write.csv(table_L.G6.poly, "table_L.G6.poly.csv")
```

# remove the objects
```{r}
rm(group_name, group_num, problem_size, problem_type, m1, pre.m1, m1.e1, m1.e2, m1.e3, m1.e4, m1.e5, m1.e6, m1.e7, m1.sq, m1.cu, aov_table, table.1, table.2)
```

# .
# .
# .
# .
# Large non-ties G6: probando sin el 17
# .
# .
# .
# .


# remove the objects
```{r}
rm(group_name, group_num, problem_size, problem_type, m1, pre.m1, m1.e1, m1.e2, m1.e3, m1.e4, m1.e5, m1.e6, m1.e7, m1.sq, m1.cu, aov_table, table.1, table.2)
```

```{r}
d <- d %>% filter(group.cod == 0.5 & item != 99 & item != 90)

xtabs(~ sum.f, data = d)
```


```{r}
# SPECIFY THE GROUP
group_num = 0.5                                                                 # -0.5 ~ grade 1; 0.5 ~ grade 6

# Grade 6 ----------------------------------------------------------------------
m1  <- lmer(log(RT) ~ sum.f.n + (1 + sum.f.n|subject) + (1|item), data = filter(d, group.cod == group_num), REML = FALSE)
summary(m1)

performance::check_model(m1)

# predictions ------------------------------------------------------------------

# pre.m1 <- ggpredict(m1, terms = "sum.f.n", se = TRUE, back.transform = FALSE)
# pre.m1
# plot(pre.m1)
# 
# # sum.f.n | Predicted |       95% CI
# # ----------------------------------
# #   -1.12 |      7.72 | [7.59, 7.86]
# #   -0.57 |      7.77 | [7.64, 7.90]
# #   -0.01 |      7.82 | [7.69, 7.95]
# #    0.54 |      7.87 | [7.73, 8.01]
# #    1.10 |      7.92 | [7.77, 8.07]
# #    1.65 |      7.97 | [7.80, 8.14]
# #    2.21 |      8.02 | [7.83, 8.21]

## Control models:
# square -----------------------------------------------------------------------
m1.sq <- lmer(log(RT) ~ sum.f.n + I(sum.f.n^2) + (1 + sum.f.n + I(sum.f.n^2)|subject) + (1|item), data = filter(d, group.cod == group_num), REML = FALSE)
summary(m1.sq)

# m1.sq <- afex::mixed(log(RT) ~ sum.f.n + I(sum.f.n^2) + (1 + sum.f.n + I(sum.f.n^2)|subject) + (1|item), data = filter(d, group.cod == group_num), method = "LRT")
# m1.sq

# cubic ------------------------------------------------------------------------
# m1.cu <- lmer(log(RT) ~ sum.f.n + I(sum.f.n^2) + I(sum.f.n^3) + (1 + sum.f.n + I(sum.f.n^2) + I(sum.f.n^3)|subject) + (1|item), data = filter(d, group.cod == group_num), REML = FALSE)
# summary(m1.cu)
# # failed to converge

m1.cu <- lmer(log(RT) ~ sum.f.n + I(sum.f.n^2) + I(sum.f.n^3) + (1 + sum.f.n + I(sum.f.n^2)|subject) + (1|item), data = filter(d, group.cod == group_num), REML = FALSE)
summary(m1.cu)
```


```{r}
## Alternative predictors ------------------------------------------------------
# m1.e1 <- lmer(log(RT) ~ pre.min.n +            (1 + pre.min.n|subject) +            (1|item), data = filter(d, group.cod == group_num), REML = FALSE)
# m1.e2 <- lmer(log(RT) ~ pre.max.n +            (1 + pre.max.n|subject) +            (1|item), data = filter(d, group.cod == group_num), REML = FALSE) # failed to converge
# m1.e3 <- lmer(log(RT) ~ pre.product.n +        (1 + pre.product.n|subject) +        (1|item), data = filter(d, group.cod == group_num), REML = FALSE)
# m1.e4 <- lmer(log(RT) ~ pre.sum_squared.n +    (1 + pre.sum_squared.n|subject) +    (1|item), data = filter(d, group.cod == group_num), REML = FALSE)
# m1.e5 <- lmer(log(RT) ~ pre.sup_op_squared.n + (1 + pre.sup_op_squared.n|subject) + (1|item), data = filter(d, group.cod == group_num), REML = FALSE) # failed to converge
# m1.e6 <- lmer(log(RT) ~ op.1.n +               (1 + op.1.n|subject) +               (1|item), data = filter(d, group.cod == group_num), REML = FALSE) # failed to converge
# m1.e7 <- lmer(log(RT) ~ op.2.n +               (1 + op.2.n|subject) +               (1|item), data = filter(d, group.cod == group_num), REML = FALSE) # failed to converge

m1.e1 <- lmer(log(RT) ~ pre.min.n +            I(pre.min.n^2)            + (1 + pre.min.n            + I(pre.min.n^2)           |subject) +    (1|item), data = filter(d, group.cod == group_num), REML = FALSE)
m1.e2 <- lmer(log(RT) ~ pre.max.n +            I(pre.max.n^2)            + (1 + pre.max.n            + I(pre.max.n^2)           |subject) +    (1|item), data = filter(d, group.cod == group_num), REML = FALSE)
m1.e3 <- lmer(log(RT) ~ pre.product.n +        I(pre.product.n^2)        + (1 + pre.product.n        + I(pre.product.n^2)       |subject) +    (1|item), data = filter(d, group.cod == group_num), REML = FALSE)
m1.e4 <- lmer(log(RT) ~ pre.sum_squared.n +    I(pre.sum_squared.n^2)    + (1 + pre.sum_squared.n    + I(pre.sum_squared.n^2)   |subject) +    (1|item), data = filter(d, group.cod == group_num), REML = FALSE)
m1.e5 <- lmer(log(RT) ~ pre.sup_op_squared.n + I(pre.sup_op_squared.n^2) + (1 + pre.sup_op_squared.n + I(pre.sup_op_squared.n^2)|subject) +    (1|item), data = filter(d, group.cod == group_num), REML = FALSE)
m1.e6 <- lmer(log(RT) ~ op.1.n +               I(op.1.n^2)               + (1 + op.1.n               + I(op.1.n^2)              |subject) +    (1|item), data = filter(d, group.cod == group_num), REML = FALSE)
m1.e7 <- lmer(log(RT) ~ op.2.n +               I(op.2.n^2)               + (1 + op.2.n               + I(op.2.n^2)              |subject) +    (1|item), data = filter(d, group.cod == group_num), REML = FALSE) #singular

summary(m1.e1)
summary(m1.e2)
summary(m1.e3)
summary(m1.e4)
summary(m1.e5)
summary(m1.e6)
summary(m1.e7)
```

THE QUADRATIC TERM IS NOT DRIVEN BY 17 ONLY


# aov_table <- anova(m1.sq,
#                    m1.e1,
#                    m1.e2, 
#                    m1.e3, 
#                    m1.e4, 
#                    m1.e5,
#                    m1.e6,
#                    m1.e7
#                    )
# ```
# 
# # Change the names for each table ----------------------------------------------
# ```{r}
# group_name = "grade 6"                                                          # grade 1 or grade 6
# problem_type = "non-tie"                                                        # non-tie or tie
# problem_size = "large"                                                          # very small, medium small, large, small
# ```
# 
# # TABLE 1: Models and control models -------------------------------------------
# ```{r}
# table.1 <- matrix(NA, nrow = 8, ncol = 13)
# colnames(table.1) <- c("age_group",
#                         "problem_type",
#                         "problem_size",
#                         "VI",
#                         "intercept estimate [log]",
#                         "VI estimate [log]",
#                         "SE",
#                         "df",
#                         "t.val",
#                         "p.val",
#                         "AIC",
#                         "BIC",
#                        "note")
# 
# table.1[,4] <- c("Sum", "Min(op.1|op.2)", "Max(op.1|op.2)", "product ~ (op.1*op.2)", "sum_sq ~ (op.1+op.2)^2", "sum_sq_op ~ op.1^2+op.2^2", "op.1", "op.2")
# 
# table.1[,1] <- group_name
# table.1[,2] <- problem_type
# table.1[,3] <- problem_size
# 
# View(table.1)
# 
# table.1[1,5] <- round(summary(m1.sq)$coef[1,1], 2)
# table.1[1,6] <- round(summary(m1.sq)$coef[2,1], 2)
# table.1[1,7] <- round(summary(m1.sq)$coef[2,2], 2)
# table.1[1,8] <- round(summary(m1.sq)$coef[2,3], 2)
# table.1[1,9] <- round(summary(m1.sq)$coef[2,4], 2)
# table.1[1,10]<- round(summary(m1.sq)$coef[2,5], 5)
# #------------------------------------------------------------------------------ Min
# table.1[2,5] <- round(summary(m1.e1)$coef[1,1], 2)
# table.1[2,6] <- round(summary(m1.e1)$coef[2,1], 2)
# table.1[2,7] <- round(summary(m1.e1)$coef[2,2], 2)
# table.1[2,8] <- round(summary(m1.e1)$coef[2,3], 2)
# table.1[2,9] <- round(summary(m1.e1)$coef[2,4], 2)
# table.1[2,10]<- round(summary(m1.e1)$coef[2,5], 5)
# #-------------------------------.---------------------------------- Max
# table.1[3,5] <- round(summary(m1.e2)$coef[1,1], 2)
# table.1[3,6] <- round(summary(m1.e2)$coef[2,1], 2)
# table.1[3,7] <- round(summary(m1.e2)$coef[2,2], 2)
# table.1[3,8] <- round(summary(m1.e2)$coef[2,3], 2)
# table.1[3,9] <- round(summary(m1.e2)$coef[2,4], 2)
# table.1[3,10]<- round(summary(m1.e2)$coef[2,5], 5)
# #-------------------------------.---------------------------------- product
# table.1[4,5] <- round(summary(m1.e3)$coef[1,1], 2)
# table.1[4,6] <- round(summary(m1.e3)$coef[2,1], 2)
# table.1[4,7] <- round(summary(m1.e3)$coef[2,2], 2)
# table.1[4,8] <- round(summary(m1.e3)$coef[2,3], 2)
# table.1[4,9] <- round(summary(m1.e3)$coef[2,4], 2)
# table.1[4,10]<- round(summary(m1.e3)$coef[2,5], 5)
# #-------------------------------.---------------------------------- sum_sq
# table.1[5,5] <- round(summary(m1.e4)$coef[1,1], 2)
# table.1[5,6] <- round(summary(m1.e4)$coef[2,1], 2)
# table.1[5,7] <- round(summary(m1.e4)$coef[2,2], 2)
# table.1[5,8] <- round(summary(m1.e4)$coef[2,3], 2)
# table.1[5,9] <- round(summary(m1.e4)$coef[2,4], 2)
# table.1[5,10]<- round(summary(m1.e4)$coef[2,5], 5)
# #-------------------------------.---------------------------------- sum_sq_op
# table.1[6,5] <- round(summary(m1.e5)$coef[1,1], 2)
# table.1[6,6] <- round(summary(m1.e5)$coef[2,1], 2)
# table.1[6,7] <- round(summary(m1.e5)$coef[2,2], 2)
# table.1[6,8] <- round(summary(m1.e5)$coef[2,3], 2)
# table.1[6,9] <- round(summary(m1.e5)$coef[2,4], 2)
# table.1[6,10]<- round(summary(m1.e5)$coef[2,5], 5)
# #-------------------------------.---------------------------------- op.1
# table.1[7,5] <- round(summary(m1.e6)$coef[1,1], 2)
# table.1[7,6] <- round(summary(m1.e6)$coef[2,1], 2)
# table.1[7,7] <- round(summary(m1.e6)$coef[2,2], 2)
# table.1[7,8] <- round(summary(m1.e6)$coef[2,3], 2)
# table.1[7,9] <- round(summary(m1.e6)$coef[2,4], 2)
# table.1[7,10]<- round(summary(m1.e6)$coef[2,5], 5)
# #-------------------------------.---------------------------------- op.2
# table.1[8,5] <- round(summary(m1.e7)$coef[1,1], 2)
# table.1[8,6] <- round(summary(m1.e7)$coef[2,1], 2)
# table.1[8,7] <- round(summary(m1.e7)$coef[2,2], 2)
# table.1[8,8] <- round(summary(m1.e7)$coef[2,3], 2)
# table.1[8,9] <- round(summary(m1.e7)$coef[2,4], 2)
# table.1[8,10]<- round(summary(m1.e7)$coef[2,5], 5)
# 
# table.1[,11]  <- round(aov_table[,2], 2)
# table.1[,12]  <- round(aov_table[,3], 2)
# 
# table.1[1,13] <- "linear term"                                                     # m1
# table.1[2,13] <- "linear term"                                                     # m1.e1
# table.1[3,13] <- "linear term"                                                     # m1.e2
# table.1[4,13] <- "linear term"                                                     # m1.e3
# table.1[5,13] <- "linear term"                                                     # m1.e4
# table.1[6,13] <- "linear term"                                                     # m1.e5
# table.1[7,13] <- "linear term"                                                     # m1.e6
# table.1[8,13] <- "linear term; singular model"                                                     # m1.e7
# 
# View(table.1)
# ```
# 
# # CHANGE THE NAME HERE:
# ```{r}
# table_L.G6_linear <- table.1 %>% as.tibble()
# write.csv(table_L.G6_linear, "table_L.G6_linear.csv")
# ```
# 
# # TABLE 1: Models and control models -------------------------------------------
# ```{r}
# table.1 <- matrix(NA, nrow = 8, ncol = 13)
# colnames(table.1) <- c("age_group",
#                         "problem_type",
#                         "problem_size",
#                         "VI",
#                         "intercept estimate [log]",
#                         "VI estimate [log]",
#                         "SE",
#                         "df",
#                         "t.val",
#                         "p.val",
#                         "AIC",
#                         "BIC",
#                        "note")
# 
# table.1[,4] <- c("Sum", "Min(op.1|op.2)", "Max(op.1|op.2)", "product ~ (op.1*op.2)", "sum_sq ~ (op.1+op.2)^2", "sum_sq_op ~ op.1^2+op.2^2", "op.1", "op.2")
# 
# table.1[,1] <- group_name
# table.1[,2] <- problem_type
# table.1[,3] <- problem_size
# 
# View(table.1)
# 
# table.1[1,5] <- round(summary(m1.sq)$coef[1,1], 2)
# table.1[1,6] <- round(summary(m1.sq)$coef[3,1], 2)
# table.1[1,7] <- round(summary(m1.sq)$coef[3,2], 2)
# table.1[1,8] <- round(summary(m1.sq)$coef[3,3], 2)
# table.1[1,9] <- round(summary(m1.sq)$coef[3,4], 2)
# table.1[1,10]<- round(summary(m1.sq)$coef[3,5], 5)
# #------------------------------------------------------------------------------ Min
# table.1[2,5] <- round(summary(m1.e1)$coef[1,1], 2)
# table.1[2,6] <- round(summary(m1.e1)$coef[3,1], 2)
# table.1[2,7] <- round(summary(m1.e1)$coef[3,2], 2)
# table.1[2,8] <- round(summary(m1.e1)$coef[3,3], 2)
# table.1[2,9] <- round(summary(m1.e1)$coef[3,4], 2)
# table.1[2,10]<- round(summary(m1.e1)$coef[3,5], 5)
# #-------------------------------.---------3------------------------ Max
# table.1[3,5] <- round(summary(m1.e2)$coef[1,1], 2)
# table.1[3,6] <- round(summary(m1.e2)$coef[3,1], 2)
# table.1[3,7] <- round(summary(m1.e2)$coef[3,2], 2)
# table.1[3,8] <- round(summary(m1.e2)$coef[3,3], 2)
# table.1[3,9] <- round(summary(m1.e2)$coef[3,4], 2)
# table.1[3,10]<- round(summary(m1.e2)$coef[3,5], 5)
# #-------------------------------.---------3------------------------ product
# table.1[4,5] <- round(summary(m1.e3)$coef[1,1], 2)
# table.1[4,6] <- round(summary(m1.e3)$coef[3,1], 2)
# table.1[4,7] <- round(summary(m1.e3)$coef[3,2], 2)
# table.1[4,8] <- round(summary(m1.e3)$coef[3,3], 2)
# table.1[4,9] <- round(summary(m1.e3)$coef[3,4], 2)
# table.1[4,10]<- round(summary(m1.e3)$coef[3,5], 5)
# #-------------------------------.---------3------------------------ sum_sq
# table.1[5,5] <- round(summary(m1.e4)$coef[1,1], 2)
# table.1[5,6] <- round(summary(m1.e4)$coef[3,1], 2)
# table.1[5,7] <- round(summary(m1.e4)$coef[3,2], 2)
# table.1[5,8] <- round(summary(m1.e4)$coef[3,3], 2)
# table.1[5,9] <- round(summary(m1.e4)$coef[3,4], 2)
# table.1[5,10]<- round(summary(m1.e4)$coef[3,5], 5)
# #-------------------------------.---------3------------------------ sum_sq_op
# table.1[6,5] <- round(summary(m1.e5)$coef[1,1], 2)
# table.1[6,6] <- round(summary(m1.e5)$coef[3,1], 2)
# table.1[6,7] <- round(summary(m1.e5)$coef[3,2], 2)
# table.1[6,8] <- round(summary(m1.e5)$coef[3,3], 2)
# table.1[6,9] <- round(summary(m1.e5)$coef[3,4], 2)
# table.1[6,10]<- round(summary(m1.e5)$coef[3,5], 5)
# #-------------------------------.---------3------------------------ op.1
# table.1[7,5] <- round(summary(m1.e6)$coef[1,1], 2)
# table.1[7,6] <- round(summary(m1.e6)$coef[3,1], 2)
# table.1[7,7] <- round(summary(m1.e6)$coef[3,2], 2)
# table.1[7,8] <- round(summary(m1.e6)$coef[3,3], 2)
# table.1[7,9] <- round(summary(m1.e6)$coef[3,4], 2)
# table.1[7,10]<- round(summary(m1.e6)$coef[3,5], 5)
# #-------------------------------.---------3------------------------ op.2
# table.1[8,5] <- round(summary(m1.e7)$coef[1,1], 2)
# table.1[8,6] <- round(summary(m1.e7)$coef[3,1], 2)
# table.1[8,7] <- round(summary(m1.e7)$coef[3,2], 2)
# table.1[8,8] <- round(summary(m1.e7)$coef[3,3], 2)
# table.1[8,9] <- round(summary(m1.e7)$coef[3,4], 2)
# table.1[8,10]<- round(summary(m1.e7)$coef[3,5], 5)
# 
# table.1[,11]  <- round(aov_table[,2], 2)
# table.1[,12]  <- round(aov_table[,3], 2)
# 
# table.1[1,13] <- "quadratic term"                                                     # m1
# table.1[2,13] <- "quadratic term"                                                     # m1.e1
# table.1[3,13] <- "quadratic term"                                                     # m1.e2
# table.1[4,13] <- "quadratic term"                                                     # m1.e3
# table.1[5,13] <- "quadratic term"                                                     # m1.e4
# table.1[6,13] <- "quadratic term"                                                     # m1.e5
# table.1[7,13] <- "quadratic term"                                                     # m1.e6
# table.1[8,13] <- "quadratic term; singular model"                                                     # m1.e7
# 
# View(table.1)
# ```
# 
# 
# # CHANGE THE NAME HERE:
# ```{r}
# table_L.G6_quadratic <- table.1 %>% as.tibble()
# write.csv(table_L.G6_quadratic, "table_L.G6_quadratic.csv")
# ```
# 
# # TABLE 2: higher order polynomials --------------------------------------------
# ```{r}
# table.2 <- matrix(NA, nrow = 6, ncol = 12) 
# 
# colnames(table.2) <- c("age_group",
#                         "problem_type",
#                         "problem_size",
#                         "model",
#                         "VI",
#                         "intercept estimate [log]",
#                         "VI estimate [log]",
#                         "SE",
#                         "df",
#                         "t.val",
#                         "p.val",
#                          "note")
# 
# table.2[,4] <- c("lineal", "cuadratic", "cuadratic", "cubic", "cubic", "cubic")
# table.2[,5] <- c("Sum", "Sum", "Sum^2", "Sum", "Sum^2", "Sum^3")
# 
# table.2[,1] <- group_name
# table.2[,2] <- problem_type
# table.2[,3] <- problem_size
# 
# View(table.2)
# 
# # linear
# table.2[1,6]  <- round(summary(m1)$coef[1,1], 2)                                # intercept estimate
# table.2[1,7]  <- round(summary(m1)$coef[2,1], 2)                                # VI estimate
# table.2[1,8]  <- round(summary(m1)$coef[2,2], 2)                                # SE
# table.2[1,9]  <- round(summary(m1)$coef[2,3], 2)                                # df
# table.2[1,10] <- round(summary(m1)$coef[2,4], 2)                                # t.val
# table.2[1,11] <- round(summary(m1)$coef[2,5], 5)                                # p.val
# # cuadratic --------------------------------------------------------
# table.2[2,6]  <- round(summary(m1.sq)$coef[1,1], 2)                             # intercept estimate
# table.2[2,7]  <- round(summary(m1.sq)$coef[2,1], 2)                             # VI estimate
# table.2[2,8]  <- round(summary(m1.sq)$coef[2,2], 2)                             # SE
# table.2[2,9]  <- round(summary(m1.sq)$coef[2,3], 2)                             # df
# table.2[2,10] <- round(summary(m1.sq)$coef[2,4], 2)                             # t.val
# table.2[2,11] <- round(summary(m1.sq)$coef[2,5], 5)                             # p.val
# # ----------------------------------------------------------------
# table.2[3,6]  <- round(summary(m1.sq)$coef[1,1], 2)                             # intercept estimate
# table.2[3,7]  <- round(summary(m1.sq)$coef[3,1], 2)                             # VI estimate
# table.2[3,8]  <- round(summary(m1.sq)$coef[3,2], 2)                             # SE
# table.2[3,9]  <- round(summary(m1.sq)$coef[3,3], 2)                             # df
# table.2[3,10] <- round(summary(m1.sq)$coef[3,4], 2)                             # t.val
# table.2[3,11] <- round(summary(m1.sq)$coef[3,5], 5)                             # p.val
# # cubic ---------------------------------------------------------
# table.2[4,6]  <- round(summary(m1.cu)$coef[1,1], 2)                             # intercept estimate
# table.2[4,7]  <- round(summary(m1.cu)$coef[2,1], 2)                             # VI estimate
# table.2[4,8]  <- round(summary(m1.cu)$coef[2,2], 2)                             # SE
# table.2[4,9]  <- round(summary(m1.cu)$coef[2,3], 2)                             # df
# table.2[4,10] <- round(summary(m1.cu)$coef[2,4], 2)                             # t.val
# table.2[4,11] <- round(summary(m1.cu)$coef[2,5], 5)                             # p.val
# # ----------------------------------------------------------------
# table.2[5,6]  <- round(summary(m1.cu)$coef[1,1], 2)                             # intercept estimate
# table.2[5,7]  <- round(summary(m1.cu)$coef[3,1], 2)                             # VI estimate
# table.2[5,8]  <- round(summary(m1.cu)$coef[3,2], 2)                             # SE
# table.2[5,9]  <- round(summary(m1.cu)$coef[3,3], 2)                             # df
# table.2[5,10] <- round(summary(m1.cu)$coef[3,4], 2)                             # t.val
# table.2[5,11] <- round(summary(m1.cu)$coef[3,5], 5)                             # p.val
# # ----------------------------------------------------------------
# table.2[6,6]  <- round(summary(m1.cu)$coef[1,1], 2)                             # intercept estimate
# table.2[6,7]  <- round(summary(m1.cu)$coef[4,1], 2)                             # VI estimate
# table.2[6,8]  <- round(summary(m1.cu)$coef[4,2], 2)                             # SE
# table.2[6,9]  <- round(summary(m1.cu)$coef[4,3], 2)                             # df
# table.2[6,10] <- round(summary(m1.cu)$coef[4,4], 2)                             # t.val
# table.2[6,11] <- round(summary(m1.cu)$coef[4,5], 5)                             # p.val
# 
# View(table.2)
# ```
# 
# # CHANGE THE NAMES HERE --------------------------------------------------------
# ```{r}
# table_L.G6.poly <- table.2 %>% as.tibble
# write.csv(table_L.G6.poly, "table_L.G6.poly.csv")
# ```
# 
# # remove the objects
# ```{r}
# rm(group_name, group_num, problem_size, problem_type, m1, pre.m1, m1.e1, m1.e2, m1.e3, m1.e4, m1.e5, m1.e6, m1.e7, m1.sq, m1.cu, aov_table, table.1, table.2)
# ```

# PUTTING IT ALL TOGETHER

```{r}
table <- rbind(table_vS.G1,
               table_mS.G1,
               table_L.G1,
               table_vS.G6,
               table_mS.G6,
               table_L.G6_linear,
               table_L.G6_quadratic)

write.csv(table, "non_tie_comparison.csv")
```


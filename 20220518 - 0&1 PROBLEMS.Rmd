---
title: "0&1 PROBLEMS"
author: "Filip Andras"
date: "5/18/2022"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


```{r}
library(tidyverse)
library(MASS)
library(naniar)
library(gridExtra)
library(lme4)
library(afex)
library(lattice)
library(ggeffects)
library(harrypotter)
library(knitr)
library(kableExtra)
library(jtools)
library(gridExtra)
library(ggpubr)
library(broom.mixed)
library(sjPlot)
```

```{r}
sessionInfo()
options(scipen = 999)
getwd()
# setwd("/Users/Filip/Desktop/PhD 2020/__20210227 - Gloria/glo_2102/glo_2102")
```

```{r}
d.outliers_without <- read_csv("d_outliers_without.csv") 
#para crear esto es hasta la línea 527 en el otro documento
#16138 data líneas
```


# 0- and 1-problems ------------------------------------------------------------

# 0-Problems
```{r}
d <- d.outliers_without %>% 
  filter(sum_n0 == 1)

d$sum.f.n <- scale(as.numeric(d$sum.f))
hist(d$sum.f.n, breaks = 20)

xtabs(~ sum.f + group.cod, data = d)


# Alternative predictors -------------------------------------------------------
# min no puedo evaluar
# product no puedo evaluar
# (0+op.2)^2 es lo mismo que 0^2+op.2^2

# d$pre.min.n            <- scale(as.numeric(d$pre.min)           , center = TRUE, scale = TRUE) # min
d$pre.max.n            <- scale(as.numeric(d$pre.max)           , center = TRUE, scale = TRUE) # max
# d$pre.product.n        <- scale(as.numeric(d$pre.product)       , center = TRUE, scale = TRUE) # product (op.1*op.2)
d$pre.sum_squared.n    <- scale(as.numeric(d$pre.sum_squared)   , center = TRUE, scale = TRUE) # sum_squared ((op.1 + op.2)^2)
# d$pre.sup_op_squared.n <- scale(as.numeric(d$pre.sum_op_squared), center = TRUE, scale = TRUE) # sum of squared operands (op.1^2 + op.2^2)
d$op.1.n               <- scale(as.numeric(d$op.1)              , center = TRUE, scale = TRUE) # op.1
d$op.2.n               <- scale(as.numeric(d$op.2)              , center = TRUE, scale = TRUE) # op.2

# hist(d$pre.min.n,            breaks = 10)
hist(d$pre.max.n,            breaks = 10)
# hist(d$pre.product.n ,       breaks = 10)
hist(d$pre.sum_squared.n,    breaks = 10)
# hist(d$pre.sup_op_squared.n, breaks = 10)
hist(d$op.1.n,               breaks = 10)
hist(d$op.2.n,               breaks = 10)
```

```{r}
# SPECIFY THE GROUP
group_num = -0.5                                                                 # -0.5 ~ grade 1; 0.5 ~ grade 6

# Grade 1 ----------------------------------------------------------------------
m1 <- lmer(log(RT) ~ sum.f.n + (1 + sum.f.n|subject) + (1|item), data = filter(d, group.cod == group_num), REML = FALSE)
summary(m1)
# ns

performance::check_model(m1)

# predictions ------------------------------------------------------------------

pre.m1 <- ggpredict(m1, terms = "sum.f.n", se = TRUE, back.transform = FALSE)
pre.m1
plot(pre.m1)

# sum.f.n | Predicted |       95% CI
# ----------------------------------
#   -1.73 |      7.20 | [7.09, 7.32]
#   -1.36 |      7.20 | [7.10, 7.30]
#   -1.00 |      7.19 | [7.10, 7.28]
#   -0.64 |      7.18 | [7.10, 7.27]
#    0.09 |      7.17 | [7.09, 7.25]
#    0.46 |      7.16 | [7.08, 7.25]
#    0.82 |      7.16 | [7.06, 7.25]
#    1.55 |      7.14 | [7.03, 7.26]
```


```{r}
## Control models:
# square -----------------------------------------------------------------------
# m1.sq <- lmer(log(RT) ~ sum.f.n + I(sum.f.n^2) + (1 + sum.f.n + I(sum.f.n^2)|subject) + (1|item), data = filter(d, group.cod == group_num), REML = FALSE)
# # singular
# summary(m1.sq)
# 
# m1.sq <- lmer(log(RT) ~ sum.f.n + I(sum.f.n^2) + (1 + sum.f.n + I(sum.f.n^2)||subject) + (1|item), data = filter(d, group.cod == group_num), REML = FALSE)
# # singular
# summary(m1.sq)

m1.sq <- lmer(log(RT) ~ sum.f.n + I(sum.f.n^2) + (1 + sum.f.n||subject) + (1|item), data = filter(d, group.cod == -0.5), REML = FALSE)
# ok
summary(m1.sq)

# cubic ------------------------------------------------------------------------
# m1.cu <- lmer(log(RT) ~ sum.f.n + I(sum.f.n^2) + I(sum.f.n^3) + (1 + sum.f.n + I(sum.f.n^2) + I(sum.f.n^3)|subject) + (1|item), data = filter(d, group.cod == group_num), REML = FALSE)
# # singular
# summary(m1.cu)
# 
# m1.cu <- lmer(log(RT) ~ sum.f.n + I(sum.f.n^2) + I(sum.f.n^3) + (1 + sum.f.n + I(sum.f.n^2) + I(sum.f.n^3)||subject) + (1|item), data = filter(d, group.cod == group_num), REML = FALSE)
# # singular
# summary(m1.cu)

m1.cu <- lmer(log(RT) ~ sum.f.n + I(sum.f.n^2) + I(sum.f.n^3) + (1 + sum.f.n|subject) + (1|item), data = filter(d, group.cod == group_num), REML = FALSE)
# ok
summary(m1.cu)

## Alternative predictors ------------------------------------------------------

# m1.e1 <- lmer(log(RT) ~ pre.min.n +            (1 + pre.min.n|subject) + (1|item),            data = filter(d, group.cod == group_num), REML = FALSE)
m1.e2 <- lmer(log(RT) ~ pre.max.n +            (1 + pre.max.n|subject) + (1|item),            data = filter(d, group.cod == group_num), REML = FALSE)
# m1.e3 <- lmer(log(RT) ~ pre.product.n +        (1 + pre.product.n|subject) + (1|item),        data = filter(d, group.cod == group_num), REML = FALSE)
m1.e4 <- lmer(log(RT) ~ pre.sum_squared.n +    (1 + pre.sum_squared.n|subject) + (1|item),    data = filter(d, group.cod == group_num), REML = FALSE)
# m1.e5 <- lmer(log(RT) ~ pre.sup_op_squared.n + (1 + pre.sup_op_squared.n|subject) + (1|item), data = filter(d, group.cod == group_num), REML = FALSE)
m1.e6 <- lmer(log(RT) ~ op.1.n +               (1 + op.1.n|subject) +               (1|item), data = filter(d, group.cod == group_num), REML = FALSE)
m1.e7 <- lmer(log(RT) ~ op.2.n +               (1 + op.2.n|subject) +               (1|item), data = filter(d, group.cod == group_num), REML = FALSE) #singular


aov_table <- anova(m1, 
             # m1.e1, 
             m1.e2, 
             # m1.e3,
             m1.e4, 
             # m1.e5,
             m1.e6,
             m1.e7
             )
```

# Change the names for each table ----------------------------------------------
```{r}
group_name = "grade 1"                                                          # grade 1 or grade 6
problem_type = "0-problems"                                                     # non-tie or tie
problem_size = "none"                                                           # very small, medium small, large, small
```

# TABLE 1: Models and control models -------------------------------------------
```{r}
table.1 <- matrix(NA, nrow = 5, ncol = 12)
colnames(table.1) <- c("age_group",
                        "problem_type",
                        "problem_size",
                        "VI",
                        "intercept estimate [log]",
                        "VI estimate [log]",
                        "SE",
                        "df",
                        "t.val",
                        "p.val",
                        "AIC",
                        "BIC")

table.1[,4] <- c("Sum", 
                 # "Min(op.1|op.2)",
                 "Max(op.1|op.2)", 
                 # "product ~ (op.1*op.2)",
                 "sum_sq ~ (op.1+op.2)^2", 
                 # "sum_sq_op ~ op.1^2+op.2^2",
                 "op.1", "op.2")

table.1[,1] <- group_name
table.1[,2] <- problem_type
table.1[,3] <- problem_size

View(table.1)

table.1[1,5] <- round(summary(m1)$coef[1,1], 2)
table.1[1,6] <- round(summary(m1)$coef[2,1], 2)
table.1[1,7] <- round(summary(m1)$coef[2,2], 2)
table.1[1,8] <- round(summary(m1)$coef[2,3], 2)
table.1[1,9] <- round(summary(m1)$coef[2,4], 2)
table.1[1,10]<- round(summary(m1)$coef[2,5], 5)
#------------------------------------------------------------------------------ Min
# table.1[2,5] <- round(summary(m1.e1)$coef[1,1], 2)
# table.1[2,6] <- round(summary(m1.e1)$coef[2,1], 2)
# table.1[2,7] <- round(summary(m1.e1)$coef[2,2], 2)
# table.1[2,8] <- round(summary(m1.e1)$coef[2,3], 2)
# table.1[2,9] <- round(summary(m1.e1)$coef[2,4], 2)
# table.1[2,10]<- round(summary(m1.e1)$coef[2,5], 5)
#-------------------------------.---------------------------------- Max
table.1[2,5] <- round(summary(m1.e2)$coef[1,1], 2)
table.1[2,6] <- round(summary(m1.e2)$coef[2,1], 2)
table.1[2,7] <- round(summary(m1.e2)$coef[2,2], 2)
table.1[2,8] <- round(summary(m1.e2)$coef[2,3], 2)
table.1[2,9] <- round(summary(m1.e2)$coef[2,4], 2)
table.1[2,10]<- round(summary(m1.e2)$coef[2,5], 5)
#-------------------------------.---------------------------------- product
# table.1[4,5] <- round(summary(m1.e3)$coef[1,1], 2)
# table.1[4,6] <- round(summary(m1.e3)$coef[2,1], 2)
# table.1[4,7] <- round(summary(m1.e3)$coef[2,2], 2)
# table.1[4,8] <- round(summary(m1.e3)$coef[2,3], 2)
# table.1[4,9] <- round(summary(m1.e3)$coef[2,4], 2)
# table.1[4,10]<- round(summary(m1.e3)$coef[2,5], 5)
#-------------------------------.---------------------------------- sum_sq
table.1[3,5] <- round(summary(m1.e4)$coef[1,1], 2)
table.1[3,6] <- round(summary(m1.e4)$coef[2,1], 2)
table.1[3,7] <- round(summary(m1.e4)$coef[2,2], 2)
table.1[3,8] <- round(summary(m1.e4)$coef[2,3], 2)
table.1[3,9] <- round(summary(m1.e4)$coef[2,4], 2)
table.1[3,10]<- round(summary(m1.e4)$coef[2,5], 5)
#-------------------------------.---------------------------------- sum_sq_op
# table.1[6,5] <- round(summary(m1.e5)$coef[1,1], 2)
# table.1[6,6] <- round(summary(m1.e5)$coef[2,1], 2)
# table.1[6,7] <- round(summary(m1.e5)$coef[2,2], 2)
# table.1[6,8] <- round(summary(m1.e5)$coef[2,3], 2)
# table.1[6,9] <- round(summary(m1.e5)$coef[2,4], 2)
# table.1[6,10]<- round(summary(m1.e5)$coef[2,5], 5)
#-------------------------------.---------------------------------- op.1
table.1[4,5] <- round(summary(m1.e6)$coef[1,1], 2)
table.1[4,6] <- round(summary(m1.e6)$coef[2,1], 2)
table.1[4,7] <- round(summary(m1.e6)$coef[2,2], 2)
table.1[4,8] <- round(summary(m1.e6)$coef[2,3], 2)
table.1[4,9] <- round(summary(m1.e6)$coef[2,4], 2)
table.1[4,10]<- round(summary(m1.e6)$coef[2,5], 5)
#-------------------------------.---------------------------------- op.2
table.1[5,5] <- round(summary(m1.e7)$coef[1,1], 2)
table.1[5,6] <- round(summary(m1.e7)$coef[2,1], 2)
table.1[5,7] <- round(summary(m1.e7)$coef[2,2], 2)
table.1[5,8] <- round(summary(m1.e7)$coef[2,3], 2)
table.1[5,9] <- round(summary(m1.e7)$coef[2,4], 2)
table.1[5,10]<- round(summary(m1.e7)$coef[2,5], 5)

table.1[,11]  <- round(aov_table[,2], 2)
table.1[,12]  <- round(aov_table[,3], 2)

View(table.1)
```

# CHANGE THE NAME HERE:
```{r}
table_n0.G1 <- table.1 %>% as.tibble()
write.csv(table_n0.G1, "table_n0.G1.csv")
```

# TABLE 2: higher order polynomials --------------------------------------------
```{r}
table.2 <- matrix(NA, nrow = 6, ncol = 12) 

colnames(table.2) <- c("age_group",
                        "problem_type",
                        "problem_size",
                        "model",
                        "VI",
                        "intercept estimate [log]",
                        "VI estimate [log]",
                        "SE",
                        "df",
                        "t.val",
                        "p.val",
                         "note")

table.2[,4] <- c("lineal", "cuadratic", "cuadratic", "cubic", "cubic", "cubic")
table.2[,5] <- c("Sum", "Sum", "Sum^2", "Sum", "Sum^2", "Sum^3")

table.2[,1] <- group_name
table.2[,2] <- problem_type
table.2[,3] <- problem_size

View(table.2)

# linear
table.2[1,6]  <- round(summary(m1)$coef[1,1], 2)                                # intercept estimate
table.2[1,7]  <- round(summary(m1)$coef[2,1], 2)                                # VI estimate
table.2[1,8]  <- round(summary(m1)$coef[2,2], 2)                                # SE
table.2[1,9]  <- round(summary(m1)$coef[2,3], 2)                                # df
table.2[1,10] <- round(summary(m1)$coef[2,4], 2)                                # t.val
table.2[1,11] <- round(summary(m1)$coef[2,5], 5)                                # p.val
# cuadratic --------------------------------------------------------
table.2[2,6]  <- round(summary(m1.sq)$coef[1,1], 2)                             # intercept estimate
table.2[2,7]  <- round(summary(m1.sq)$coef[2,1], 2)                             # VI estimate
table.2[2,8]  <- round(summary(m1.sq)$coef[2,2], 2)                             # SE
table.2[2,9]  <- round(summary(m1.sq)$coef[2,3], 2)                             # df
table.2[2,10] <- round(summary(m1.sq)$coef[2,4], 2)                             # t.val
table.2[2,11] <- round(summary(m1.sq)$coef[2,5], 5)                             # p.val
# ----------------------------------------------------------------
table.2[3,6]  <- round(summary(m1.sq)$coef[1,1], 2)                             # intercept estimate
table.2[3,7]  <- round(summary(m1.sq)$coef[3,1], 2)                             # VI estimate
table.2[3,8]  <- round(summary(m1.sq)$coef[3,2], 2)                             # SE
table.2[3,9]  <- round(summary(m1.sq)$coef[3,3], 2)                             # df
table.2[3,10] <- round(summary(m1.sq)$coef[3,4], 2)                             # t.val
table.2[3,11] <- round(summary(m1.sq)$coef[3,5], 5)                             # p.val
# cubic ---------------------------------------------------------
table.2[4,6]  <- round(summary(m1.cu)$coef[1,1], 2)                             # intercept estimate
table.2[4,7]  <- round(summary(m1.cu)$coef[2,1], 2)                             # VI estimate
table.2[4,8]  <- round(summary(m1.cu)$coef[2,2], 2)                             # SE
table.2[4,9]  <- round(summary(m1.cu)$coef[2,3], 2)                             # df
table.2[4,10] <- round(summary(m1.cu)$coef[2,4], 2)                             # t.val
table.2[4,11] <- round(summary(m1.cu)$coef[2,5], 5)                             # p.val
# ----------------------------------------------------------------
table.2[5,6]  <- round(summary(m1.cu)$coef[1,1], 2)                             # intercept estimate
table.2[5,7]  <- round(summary(m1.cu)$coef[3,1], 2)                             # VI estimate
table.2[5,8]  <- round(summary(m1.cu)$coef[3,2], 2)                             # SE
table.2[5,9]  <- round(summary(m1.cu)$coef[3,3], 2)                             # df
table.2[5,10] <- round(summary(m1.cu)$coef[3,4], 2)                             # t.val
table.2[5,11] <- round(summary(m1.cu)$coef[3,5], 5)                             # p.val
# ----------------------------------------------------------------
table.2[6,6]  <- round(summary(m1.cu)$coef[1,1], 2)                             # intercept estimate
table.2[6,7]  <- round(summary(m1.cu)$coef[4,1], 2)                             # VI estimate
table.2[6,8]  <- round(summary(m1.cu)$coef[4,2], 2)                             # SE
table.2[6,9]  <- round(summary(m1.cu)$coef[4,3], 2)                             # df
table.2[6,10] <- round(summary(m1.cu)$coef[4,4], 2)                             # t.val
table.2[6,11] <- round(summary(m1.cu)$coef[4,5], 5)                             # p.val

View(table.2)
```

# CHANGE THE NAMES HERE --------------------------------------------------------
```{r}
table_n0.G1.poly <- table.2 %>% as.tibble
write.csv(table_n0.G1.poly, "table_n0.G1.poly.csv")
```

# remove the objects
```{r}
rm(group_name, group_num, problem_size, problem_type, m1, pre.m1, m1.e1, m1.e2, m1.e3, m1.e4, m1.e5, m1.e6, m1.e7, m1.sq, m1.cu, aov_table, table.1, table.2)
```

```{r}
# SPECIFY THE GROUP
group_num = 0.5                                                                 # -0.5 ~ grade 1; 0.5 ~ grade 6

# m0 <- lmer(log(RT) ~ 1 + (1|subject) + (1|item), data = filter(d, group.cod == group_num), REML = FALSE)
# 
# performance::check_model(m0)
# 
# # predictions ------------------------------------------------------------------
# 
# # pre.m0 <- ggpredict(m0, terms = "sum.f.n", se = TRUE, back.transform = FALSE)
# # pre.m0
# # plot(pre.m0)


# Grade 6 ----------------------------------------------------------------------
# m1  <- lmer(log(RT) ~ sum.f.n + (1 + sum.f.n|subject) + (1|item), data = filter(d, group.cod == group_num), REML = FALSE)
# summary(m1)
# # singular: correlación
# 
# m1  <- lmer(log(RT) ~ sum.f.n + (1 + sum.f.n||subject) + (1|item), data = filter(d, group.cod == group_num), REML = FALSE)
# summary(m1)
# # singular: sum.f.n slope

m1  <- lmer(log(RT) ~ sum.f.n + (1|subject) + (1|item), data = filter(d, group.cod == group_num), REML = FALSE)
summary(m1)

performance::check_model(m1)

# predictions ------------------------------------------------------------------

pre.m1 <- ggpredict(m1, terms = "sum.f.n", se = TRUE, back.transform = FALSE)
pre.m1
plot(pre.m1)

# sum.f.n | Predicted |       95% CI
# ----------------------------------
#   -1.73 |      6.78 | [6.70, 6.85]
#   -1.36 |      6.78 | [6.70, 6.85]
#   -1.00 |      6.77 | [6.70, 6.85]
#   -0.64 |      6.77 | [6.70, 6.84]
#    0.09 |      6.77 | [6.70, 6.84]
#    0.46 |      6.77 | [6.70, 6.84]
#    0.82 |      6.77 | [6.70, 6.84]
#    1.55 |      6.77 | [6.70, 6.84]
```


```{r}
## Control models:
# square -----------------------------------------------------------------------
# m1.sq <- lmer(log(RT) ~ sum.f.n + I(sum.f.n^2) + (1 + sum.f.n + I(sum.f.n^2)|subject) + (1|item), data = filter(d, group.cod == group_num), REML = FALSE)
# # singular
# summary(m1.sq)
# 
# m1.sq <- lmer(log(RT) ~ sum.f.n + I(sum.f.n^2) + (1 + sum.f.n|subject) + (1|item), data = filter(d, group.cod == group_num), REML = FALSE)
# # singular
# summary(m1.sq)

m1.sq <- lmer(log(RT) ~ sum.f.n + I(sum.f.n^2) + (1|subject) + (1|item), data = filter(d, group.cod == group_num), REML = FALSE)
# ok
summary(m1.sq)

# cubic ------------------------------------------------------------------------
# m1.cu <- lmer(log(RT) ~ sum.f.n + I(sum.f.n^2) + I(sum.f.n^3) + (1 + sum.f.n + I(sum.f.n^2) + I(sum.f.n^3)|subject) + (1|item), data = filter(d, group.cod == group_num), REML = FALSE)
# # singular
# summary(m1.cu)
# 
# m1.cu <- lmer(log(RT) ~ sum.f.n + I(sum.f.n^2) + I(sum.f.n^3) + (1 + sum.f.n + I(sum.f.n^2) + I(sum.f.n^3)||subject) + (1|item), data = filter(d, group.cod == group_num), REML = FALSE)
# # singular
# summary(m1.cu)

m1.cu <- lmer(log(RT) ~ sum.f.n + I(sum.f.n^2) + I(sum.f.n^3) + (1|subject) + (1|item), data = filter(d, group.cod == group_num), REML = FALSE)
# ok
summary(m1.cu)

## Alternative predictors ------------------------------------------------------
# m1.e1 <- lmer(log(RT) ~ pre.min.n +            (1 + pre.min.n|subject) + (1|item),            data = filter(d, group.cod == group_num), REML = FALSE)
m1.e2 <- lmer(log(RT) ~ pre.max.n +            (1 + pre.max.n|subject) + (1|item),            data = filter(d, group.cod == group_num), REML = FALSE) #singular
# m1.e3 <- lmer(log(RT) ~ pre.product.n +        (1 + pre.product.n|subject) + (1|item),        data = filter(d, group.cod == group_num), REML = FALSE)
m1.e4 <- lmer(log(RT) ~ pre.sum_squared.n +    (1 + pre.sum_squared.n|subject) + (1|item),    data = filter(d, group.cod == group_num), REML = FALSE) #singular
# m1.e5 <- lmer(log(RT) ~ pre.sup_op_squared.n + (1 + pre.sup_op_squared.n|subject) + (1|item), data = filter(d, group.cod == group_num), REML = FALSE)
m1.e6 <- lmer(log(RT) ~ op.1.n +               (1 + op.1.n|subject) +               (1|item), data = filter(d, group.cod == group_num), REML = FALSE) #singular
m1.e7 <- lmer(log(RT) ~ op.2.n +               (1 + op.2.n|subject) +               (1|item), data = filter(d, group.cod == group_num), REML = FALSE) #singular


aov_table <- anova(m1, 
             # m1.e1, 
             m1.e2, 
             # m1.e3,
             m1.e4, 
             # m1.e5,
             m1.e6,
             m1.e7
             )
```
# Change the names for each table ----------------------------------------------
```{r}
group_name = "grade 6"                                                          # grade 1 or grade 6
problem_type = "0-problems"                                                        # non-tie or tie
problem_size = "none"                                                     # very small, medium small, large, small
```

# TABLE 1: Models and control models -------------------------------------------
```{r}
table.1 <- matrix(NA, nrow = 5, ncol = 12)
colnames(table.1) <- c("age_group",
                        "problem_type",
                        "problem_size",
                        "VI",
                        "intercept estimate [log]",
                        "VI estimate [log]",
                        "SE",
                        "df",
                        "t.val",
                        "p.val",
                        "AIC",
                        "BIC")

table.1[,4] <- c("Sum", 
                 # "Min(op.1|op.2)",
                 "Max(op.1|op.2)", 
                 # "product ~ (op.1*op.2)",
                 "sum_sq ~ (op.1+op.2)^2", 
                 # "sum_sq_op ~ op.1^2+op.2^2",
                 "op.1", "op.2")

table.1[,1] <- group_name
table.1[,2] <- problem_type
table.1[,3] <- problem_size

View(table.1)

table.1[1,5] <- round(summary(m1)$coef[1,1], 2)
table.1[1,6] <- round(summary(m1)$coef[2,1], 2)
table.1[1,7] <- round(summary(m1)$coef[2,2], 2)
table.1[1,8] <- round(summary(m1)$coef[2,3], 2)
table.1[1,9] <- round(summary(m1)$coef[2,4], 2)
table.1[1,10]<- round(summary(m1)$coef[2,5], 5)
#------------------------------------------------------------------------------ Min
# table.1[2,5] <- round(summary(m1.e1)$coef[1,1], 2)
# table.1[2,6] <- round(summary(m1.e1)$coef[2,1], 2)
# table.1[2,7] <- round(summary(m1.e1)$coef[2,2], 2)
# table.1[2,8] <- round(summary(m1.e1)$coef[2,3], 2)
# table.1[2,9] <- round(summary(m1.e1)$coef[2,4], 2)
# table.1[2,10]<- round(summary(m1.e1)$coef[2,5], 5)
#-------------------------------.---------------------------------- Max
table.1[2,5] <- round(summary(m1.e2)$coef[1,1], 2)
table.1[2,6] <- round(summary(m1.e2)$coef[2,1], 2)
table.1[2,7] <- round(summary(m1.e2)$coef[2,2], 2)
table.1[2,8] <- round(summary(m1.e2)$coef[2,3], 2)
table.1[2,9] <- round(summary(m1.e2)$coef[2,4], 2)
table.1[2,10]<- round(summary(m1.e2)$coef[2,5], 5)
#-------------------------------.---------------------------------- product
# table.1[4,5] <- round(summary(m1.e3)$coef[1,1], 2)
# table.1[4,6] <- round(summary(m1.e3)$coef[2,1], 2)
# table.1[4,7] <- round(summary(m1.e3)$coef[2,2], 2)
# table.1[4,8] <- round(summary(m1.e3)$coef[2,3], 2)
# table.1[4,9] <- round(summary(m1.e3)$coef[2,4], 2)
# table.1[4,10]<- round(summary(m1.e3)$coef[2,5], 5)
#-------------------------------.---------------------------------- sum_sq
table.1[3,5] <- round(summary(m1.e4)$coef[1,1], 2)
table.1[3,6] <- round(summary(m1.e4)$coef[2,1], 2)
table.1[3,7] <- round(summary(m1.e4)$coef[2,2], 2)
table.1[3,8] <- round(summary(m1.e4)$coef[2,3], 2)
table.1[3,9] <- round(summary(m1.e4)$coef[2,4], 2)
table.1[3,10]<- round(summary(m1.e4)$coef[2,5], 5)
#-------------------------------.---------------------------------- sum_sq_op
# table.1[6,5] <- round(summary(m1.e5)$coef[1,1], 2)
# table.1[6,6] <- round(summary(m1.e5)$coef[2,1], 2)
# table.1[6,7] <- round(summary(m1.e5)$coef[2,2], 2)
# table.1[6,8] <- round(summary(m1.e5)$coef[2,3], 2)
# table.1[6,9] <- round(summary(m1.e5)$coef[2,4], 2)
# table.1[6,10]<- round(summary(m1.e5)$coef[2,5], 5)
#-------------------------------.---------------------------------- op.1
table.1[4,5] <- round(summary(m1.e6)$coef[1,1], 2)
table.1[4,6] <- round(summary(m1.e6)$coef[2,1], 2)
table.1[4,7] <- round(summary(m1.e6)$coef[2,2], 2)
table.1[4,8] <- round(summary(m1.e6)$coef[2,3], 2)
table.1[4,9] <- round(summary(m1.e6)$coef[2,4], 2)
table.1[4,10]<- round(summary(m1.e6)$coef[2,5], 5)
#-------------------------------.---------------------------------- op.2
table.1[5,5] <- round(summary(m1.e7)$coef[1,1], 2)
table.1[5,6] <- round(summary(m1.e7)$coef[2,1], 2)
table.1[5,7] <- round(summary(m1.e7)$coef[2,2], 2)
table.1[5,8] <- round(summary(m1.e7)$coef[2,3], 2)
table.1[5,9] <- round(summary(m1.e7)$coef[2,4], 2)
table.1[5,10]<- round(summary(m1.e7)$coef[2,5], 5)

table.1[,11]  <- round(aov_table[,2], 2)
table.1[,12]  <- round(aov_table[,3], 2)

View(table.1)
```

# CHANGE THE NAME HERE:
```{r}
table_n0.G6 <- table.1 %>% as.tibble()
write.csv(table_n0.G6, "table_n0.G6.csv")
```

# TABLE 2: higher order polynomials --------------------------------------------
```{r}
table.2 <- matrix(NA, nrow = 6, ncol = 12) 

colnames(table.2) <- c("age_group",
                        "problem_type",
                        "problem_size",
                        "model",
                        "VI",
                        "intercept estimate [log]",
                        "VI estimate [log]",
                        "SE",
                        "df",
                        "t.val",
                        "p.val",
                         "note")

table.2[,4] <- c("lineal", "cuadratic", "cuadratic", "cubic", "cubic", "cubic")
table.2[,5] <- c("Sum", "Sum", "Sum^2", "Sum", "Sum^2", "Sum^3")

table.2[,1] <- group_name
table.2[,2] <- problem_type
table.2[,3] <- problem_size

View(table.2)

# linear
table.2[1,6]  <- round(summary(m1)$coef[1,1], 2)                                # intercept estimate
table.2[1,7]  <- round(summary(m1)$coef[2,1], 2)                                # VI estimate
table.2[1,8]  <- round(summary(m1)$coef[2,2], 2)                                # SE
table.2[1,9]  <- round(summary(m1)$coef[2,3], 2)                                # df
table.2[1,10] <- round(summary(m1)$coef[2,4], 2)                                # t.val
table.2[1,11] <- round(summary(m1)$coef[2,5], 5)                                # p.val
# cuadratic --------------------------------------------------------
table.2[2,6]  <- round(summary(m1.sq)$coef[1,1], 2)                             # intercept estimate
table.2[2,7]  <- round(summary(m1.sq)$coef[2,1], 2)                             # VI estimate
table.2[2,8]  <- round(summary(m1.sq)$coef[2,2], 2)                             # SE
table.2[2,9]  <- round(summary(m1.sq)$coef[2,3], 2)                             # df
table.2[2,10] <- round(summary(m1.sq)$coef[2,4], 2)                             # t.val
table.2[2,11] <- round(summary(m1.sq)$coef[2,5], 5)                             # p.val
# ----------------------------------------------------------------
table.2[3,6]  <- round(summary(m1.sq)$coef[1,1], 2)                             # intercept estimate
table.2[3,7]  <- round(summary(m1.sq)$coef[3,1], 2)                             # VI estimate
table.2[3,8]  <- round(summary(m1.sq)$coef[3,2], 2)                             # SE
table.2[3,9]  <- round(summary(m1.sq)$coef[3,3], 2)                             # df
table.2[3,10] <- round(summary(m1.sq)$coef[3,4], 2)                             # t.val
table.2[3,11] <- round(summary(m1.sq)$coef[3,5], 5)                             # p.val
# cubic ---------------------------------------------------------
table.2[4,6]  <- round(summary(m1.cu)$coef[1,1], 2)                             # intercept estimate
table.2[4,7]  <- round(summary(m1.cu)$coef[2,1], 2)                             # VI estimate
table.2[4,8]  <- round(summary(m1.cu)$coef[2,2], 2)                             # SE
table.2[4,9]  <- round(summary(m1.cu)$coef[2,3], 2)                             # df
table.2[4,10] <- round(summary(m1.cu)$coef[2,4], 2)                             # t.val
table.2[4,11] <- round(summary(m1.cu)$coef[2,5], 5)                             # p.val
# ----------------------------------------------------------------
table.2[5,6]  <- round(summary(m1.cu)$coef[1,1], 2)                             # intercept estimate
table.2[5,7]  <- round(summary(m1.cu)$coef[3,1], 2)                             # VI estimate
table.2[5,8]  <- round(summary(m1.cu)$coef[3,2], 2)                             # SE
table.2[5,9]  <- round(summary(m1.cu)$coef[3,3], 2)                             # df
table.2[5,10] <- round(summary(m1.cu)$coef[3,4], 2)                             # t.val
table.2[5,11] <- round(summary(m1.cu)$coef[3,5], 5)                             # p.val
# ----------------------------------------------------------------
table.2[6,6]  <- round(summary(m1.cu)$coef[1,1], 2)                             # intercept estimate
table.2[6,7]  <- round(summary(m1.cu)$coef[4,1], 2)                             # VI estimate
table.2[6,8]  <- round(summary(m1.cu)$coef[4,2], 2)                             # SE
table.2[6,9]  <- round(summary(m1.cu)$coef[4,3], 2)                             # df
table.2[6,10] <- round(summary(m1.cu)$coef[4,4], 2)                             # t.val
table.2[6,11] <- round(summary(m1.cu)$coef[4,5], 5)                             # p.val

View(table.2)
```

# CHANGE THE NAMES HERE --------------------------------------------------------
```{r}
table_n0.G6.poly <- table.2 %>% as.tibble
write.csv(table_n0.G6.poly, "table_n0.G6.poly.csv")
```

# remove the objects
```{r}
rm(group_name, group_num, problem_size, problem_type, m1, pre.m1, m1.e1, m1.e2, m1.e3, m1.e4, m1.e5, m1.e6, m1.e7, m1.sq, m1.cu, aov_table, table.1, table.2)
```

# 1-problems --------------------------------------------------------------------
```{r}
d <- d.outliers_without %>% 
  filter(sum_n1 == 1)

d$sum.f.n <- scale(as.numeric(d$sum.f))
hist(d$sum.f.n, breaks = 20)

xtabs(~ sum.f + group.cod, data = d)

# Alternative predictors -------------------------------------------------------
# min no puedo evaluar
# product no puedo evaluar
```


```{r}
# (1+op.2)^2 es lo mismo que 1^2+op.2^2

#y op.1/op.2?
```


```{r}
# d$pre.min.n            <- scale(as.numeric(d$pre.min)           , center = TRUE, scale = TRUE) # min
d$pre.max.n            <- scale(as.numeric(d$pre.max)           , center = TRUE, scale = TRUE) # max
# d$pre.product.n        <- scale(as.numeric(d$pre.product)       , center = TRUE, scale = TRUE) # product (op.1*op.2)
d$pre.sum_squared.n    <- scale(as.numeric(d$pre.sum_squared)   , center = TRUE, scale = TRUE) # sum_squared ((op.1 + op.2)^2)
d$pre.sup_op_squared.n <- scale(as.numeric(d$pre.sum_op_squared), center = TRUE, scale = TRUE) # sum of squared operands (op.1^2 + op.2^2)
d$op.1.n               <- scale(as.numeric(d$op.1)              , center = TRUE, scale = TRUE) # op.1
d$op.2.n               <- scale(as.numeric(d$op.2)              , center = TRUE, scale = TRUE) # op.2

# hist(d$pre.min.n,            breaks = 10)
hist(d$pre.max.n,            breaks = 10)
# hist(d$pre.product.n ,       breaks = 10)
hist(d$pre.sum_squared.n,    breaks = 10)
hist(d$pre.sup_op_squared.n, breaks = 10)
hist(d$op.1.n,               breaks = 10)
hist(d$op.2.n,               breaks = 10)
```

```{r}
# Grade 1 ----------------------------------------------------------------------
group_num = -0.5                                                                 # -0.5 ~ grade 1; 0.5 ~ grade 6

m1 <- lmer(log(RT) ~ sum.f.n + (1 + sum.f.n|subject) + (1|item), data = filter(d, group.cod == group_num), REML = FALSE)
summary(m1)

performance::check_model(m1)

#processing speed
m1.ps <- lmer(log(RT) ~ sum.f.n + (1 + sum.f.n|subject) + (1|item), data = filter(d, group.cod == group_num), REML = FALSE)
summary(m1)

performance::check_model(m1.ps)

# predictions ------------------------------------------------------------------

pre.m1 <- ggpredict(m1, terms = "sum.f.n", se = TRUE, back.transform = FALSE)
pre.m1
plot(pre.m1)

# sum.f.n | Predicted |       95% CI
# ----------------------------------
#   -1.52 |      7.60 | [7.47, 7.73]
#   -1.09 |      7.61 | [7.49, 7.73]
#   -0.65 |      7.62 | [7.50, 7.74]
#   -0.22 |      7.63 | [7.51, 7.75]
#    0.22 |      7.64 | [7.51, 7.76]
#    0.66 |      7.64 | [7.52, 7.77]
#    1.09 |      7.65 | [7.51, 7.79]
#    1.53 |      7.66 | [7.51, 7.82]
```


```{r}
## Control models:
# square -----------------------------------------------------------------------
m1.sq <- lmer(log(RT) ~ sum.f.n + I(sum.f.n^2) + (1 + sum.f.n + I(sum.f.n^2)|subject) + (1|item), data = filter(d, group.cod == group_num), REML = FALSE)
summary(m1.sq)

# performance::check_model(m1.sq)

# predictions ------------------------------------------------------------------

plot.m1.sq <- ggpredict(m1.sq, terms = "sum.f.n[all]", se = TRUE, back.transform = FALSE)
plot.m1.sq
plot(plot.m1.sq)

# sum.f.n | Predicted |       95% CI
# ----------------------------------
#   -1.52 |      7.52 | [7.40, 7.63]
#   -1.09 |      7.60 | [7.48, 7.71]
#   -0.65 |      7.66 | [7.53, 7.78]
#   -0.22 |      7.69 | [7.55, 7.83]
#    0.22 |      7.70 | [7.56, 7.84]
#    0.66 |      7.68 | [7.55, 7.82]
#    1.09 |      7.64 | [7.51, 7.77]
#    1.53 |      7.57 | [7.43, 7.72]

# cubic ------------------------------------------------------------------------
# m1.cu <- lmer(log(RT) ~ sum.f.n + I(sum.f.n^2) + I(sum.f.n^3) + (1 + sum.f.n + I(sum.f.n^2) + I(sum.f.n^3)|subject) + (1|item), data = filter(d, group.cod == group_num), REML = FALSE)
# # singular
# summary(m1.cu)
# 
# m1.cu <- lmer(log(RT) ~ sum.f.n + I(sum.f.n^2) + I(sum.f.n^3) + (1 + sum.f.n + I(sum.f.n^2) + I(sum.f.n^3)||subject) + (1|item), data = filter(d, group.cod == group_num), REML = FALSE)
# # singular
# summary(m1.cu)

m1.cu <- lmer(log(RT) ~ sum.f.n + I(sum.f.n^2) + I(sum.f.n^3) + (1 + sum.f.n + I(sum.f.n^2)|subject) + (1|item), data = filter(d, group.cod == group_num), REML = FALSE)
# ok
summary(m1.cu)

## Alternative predictors ------------------------------------------------------

# m1.e1 <- lmer(log(RT) ~ pre.min.n +            (1 + pre.min.n|subject) + (1|item),            data = filter(d, group.cod == group_num), REML = FALSE)
m1.e2 <- lmer(log(RT) ~ pre.max.n +            (1 + pre.max.n|subject) + (1|item),            data = filter(d, group.cod == group_num), REML = FALSE)
# m1.e3 <- lmer(log(RT) ~ pre.product.n +        (1 + pre.product.n|subject) + (1|item),        data = filter(d, group.cod == group_num), REML = FALSE)
m1.e4 <- lmer(log(RT) ~ pre.sum_squared.n +    (1 + pre.sum_squared.n|subject) + (1|item),    data = filter(d, group.cod == group_num), REML = FALSE)
m1.e5 <- lmer(log(RT) ~ pre.sup_op_squared.n + (1 + pre.sup_op_squared.n|subject) + (1|item), data = filter(d, group.cod == group_num), REML = FALSE)
m1.e6 <- lmer(log(RT) ~ op.1.n +               (1 + op.1.n|subject) +               (1|item), data = filter(d, group.cod == group_num), REML = FALSE)
m1.e7 <- lmer(log(RT) ~ op.2.n +               (1 + op.2.n|subject) +               (1|item), data = filter(d, group.cod == group_num), REML = FALSE) #singular


aov_table <- anova(m1, 
             # m1.e1, 
             m1.e2, 
             # m1.e3,
             m1.e4, 
             m1.e5,
             m1.e6,
             m1.e7
             )
```

# Change the names for each table ----------------------------------------------
```{r}
group_name = "grade 1"                                                          # grade 1 or grade 6
problem_type = "1-problems"                                                     # non-tie or tie
problem_size = ""                                                               # very small, medium small, large, small
```

# TABLE 1: Models and control models -------------------------------------------
```{r}
table.1 <- matrix(NA, nrow = 6, ncol = 12)
colnames(table.1) <- c("age_group",
                        "problem_type",
                        "problem_size",
                        "VI",
                        "intercept estimate [log]",
                        "VI estimate [log]",
                        "SE",
                        "df",
                        "t.val",
                        "p.val",
                        "AIC",
                        "BIC")

table.1[,4] <- c("Sum", 
                 # "Min(op.1|op.2)", 
                 "Max(op.1|op.2)", 
                 # "product ~ (op.1*op.2)", 
                 "sum_sq ~ (op.1+op.2)^2", 
                 "sum_sq_op ~ op.1^2+op.2^2", 
                 "op.1", "op.2")

table.1[,1] <- group_name
table.1[,2] <- problem_type
table.1[,3] <- problem_size

View(table.1)

table.1[1,5] <- round(summary(m1)$coef[1,1], 2)
table.1[1,6] <- round(summary(m1)$coef[2,1], 2)
table.1[1,7] <- round(summary(m1)$coef[2,2], 2)
table.1[1,8] <- round(summary(m1)$coef[2,3], 2)
table.1[1,9] <- round(summary(m1)$coef[2,4], 2)
table.1[1,10]<- round(summary(m1)$coef[2,5], 5)
#------------------------------------------------------------------------------ Min
# table.1[2,5] <- round(summary(m1.e1)$coef[1,1], 2)
# table.1[2,6] <- round(summary(m1.e1)$coef[2,1], 2)
# table.1[2,7] <- round(summary(m1.e1)$coef[2,2], 2)
# table.1[2,8] <- round(summary(m1.e1)$coef[2,3], 2)
# table.1[2,9] <- round(summary(m1.e1)$coef[2,4], 2)
# table.1[2,10]<- round(summary(m1.e1)$coef[2,5], 5)
#-------------------------------.---------------------------------- Max
table.1[2,5] <- round(summary(m1.e2)$coef[1,1], 2)
table.1[2,6] <- round(summary(m1.e2)$coef[2,1], 2)
table.1[2,7] <- round(summary(m1.e2)$coef[2,2], 2)
table.1[2,8] <- round(summary(m1.e2)$coef[2,3], 2)
table.1[2,9] <- round(summary(m1.e2)$coef[2,4], 2)
table.1[2,10]<- round(summary(m1.e2)$coef[2,5], 5)
#-------------------------------.---------------------------------- product
# table.1[4,5] <- round(summary(m1.e3)$coef[1,1], 2)
# table.1[4,6] <- round(summary(m1.e3)$coef[2,1], 2)
# table.1[4,7] <- round(summary(m1.e3)$coef[2,2], 2)
# table.1[4,8] <- round(summary(m1.e3)$coef[2,3], 2)
# table.1[4,9] <- round(summary(m1.e3)$coef[2,4], 2)
# table.1[4,10]<- round(summary(m1.e3)$coef[2,5], 5)
#-------------------------------.---------------------------------- sum_sq
table.1[3,5] <- round(summary(m1.e4)$coef[1,1], 2)
table.1[3,6] <- round(summary(m1.e4)$coef[2,1], 2)
table.1[3,7] <- round(summary(m1.e4)$coef[2,2], 2)
table.1[3,8] <- round(summary(m1.e4)$coef[2,3], 2)
table.1[3,9] <- round(summary(m1.e4)$coef[2,4], 2)
table.1[3,10]<- round(summary(m1.e4)$coef[2,5], 5)
#-------------------------------.---------------------------------- sum_sq_op
table.1[4,5] <- round(summary(m1.e5)$coef[1,1], 2)
table.1[4,6] <- round(summary(m1.e5)$coef[2,1], 2)
table.1[4,7] <- round(summary(m1.e5)$coef[2,2], 2)
table.1[4,8] <- round(summary(m1.e5)$coef[2,3], 2)
table.1[4,9] <- round(summary(m1.e5)$coef[2,4], 2)
table.1[4,10]<- round(summary(m1.e5)$coef[2,5], 5)
#-------------------------------.---------------------------------- op.1
table.1[5,5] <- round(summary(m1.e6)$coef[1,1], 2)
table.1[5,6] <- round(summary(m1.e6)$coef[2,1], 2)
table.1[5,7] <- round(summary(m1.e6)$coef[2,2], 2)
table.1[5,8] <- round(summary(m1.e6)$coef[2,3], 2)
table.1[5,9] <- round(summary(m1.e6)$coef[2,4], 2)
table.1[5,10]<- round(summary(m1.e6)$coef[2,5], 5)
#-------------------------------.---------------------------------- op.2
table.1[6,5] <- round(summary(m1.e7)$coef[1,1], 2)
table.1[6,6] <- round(summary(m1.e7)$coef[2,1], 2)
table.1[6,7] <- round(summary(m1.e7)$coef[2,2], 2)
table.1[6,8] <- round(summary(m1.e7)$coef[2,3], 2)
table.1[6,9] <- round(summary(m1.e7)$coef[2,4], 2)
table.1[6,10]<- round(summary(m1.e7)$coef[2,5], 5)

table.1[,11]  <- round(aov_table[,2], 2)
table.1[,12]  <- round(aov_table[,3], 2)

View(table.1)
```

# CHANGE THE NAME HERE:
```{r}
table_n1.G1 <- table.1 %>% as.tibble()
write.csv(table_n1.G1, "table_n1.G1.csv")
```

# TABLE 2: higher order polynomials --------------------------------------------
```{r}
table.2 <- matrix(NA, nrow = 6, ncol = 12) 

colnames(table.2) <- c("age_group",
                        "problem_type",
                        "problem_size",
                        "model",
                        "VI",
                        "intercept estimate [log]",
                        "VI estimate [log]",
                        "SE",
                        "df",
                        "t.val",
                        "p.val",
                         "note")

table.2[,4] <- c("lineal", "cuadratic", "cuadratic", "cubic", "cubic", "cubic")
table.2[,5] <- c("Sum", "Sum", "Sum^2", "Sum", "Sum^2", "Sum^3")

table.2[,1] <- group_name
table.2[,2] <- problem_type
table.2[,3] <- problem_size

View(table.2)

# linear
table.2[1,6]  <- round(summary(m1)$coef[1,1], 2)                                # intercept estimate
table.2[1,7]  <- round(summary(m1)$coef[2,1], 2)                                # VI estimate
table.2[1,8]  <- round(summary(m1)$coef[2,2], 2)                                # SE
table.2[1,9]  <- round(summary(m1)$coef[2,3], 2)                                # df
table.2[1,10] <- round(summary(m1)$coef[2,4], 2)                                # t.val
table.2[1,11] <- round(summary(m1)$coef[2,5], 5)                                # p.val
# cuadratic --------------------------------------------------------
table.2[2,6]  <- round(summary(m1.sq)$coef[1,1], 2)                             # intercept estimate
table.2[2,7]  <- round(summary(m1.sq)$coef[2,1], 2)                             # VI estimate
table.2[2,8]  <- round(summary(m1.sq)$coef[2,2], 2)                             # SE
table.2[2,9]  <- round(summary(m1.sq)$coef[2,3], 2)                             # df
table.2[2,10] <- round(summary(m1.sq)$coef[2,4], 2)                             # t.val
table.2[2,11] <- round(summary(m1.sq)$coef[2,5], 5)                             # p.val
# ----------------------------------------------------------------
table.2[3,6]  <- round(summary(m1.sq)$coef[1,1], 2)                             # intercept estimate
table.2[3,7]  <- round(summary(m1.sq)$coef[3,1], 2)                             # VI estimate
table.2[3,8]  <- round(summary(m1.sq)$coef[3,2], 2)                             # SE
table.2[3,9]  <- round(summary(m1.sq)$coef[3,3], 2)                             # df
table.2[3,10] <- round(summary(m1.sq)$coef[3,4], 2)                             # t.val
table.2[3,11] <- round(summary(m1.sq)$coef[3,5], 5)                             # p.val
# cubic ---------------------------------------------------------
table.2[4,6]  <- round(summary(m1.cu)$coef[1,1], 2)                             # intercept estimate
table.2[4,7]  <- round(summary(m1.cu)$coef[2,1], 2)                             # VI estimate
table.2[4,8]  <- round(summary(m1.cu)$coef[2,2], 2)                             # SE
table.2[4,9]  <- round(summary(m1.cu)$coef[2,3], 2)                             # df
table.2[4,10] <- round(summary(m1.cu)$coef[2,4], 2)                             # t.val
table.2[4,11] <- round(summary(m1.cu)$coef[2,5], 5)                             # p.val
# ----------------------------------------------------------------
table.2[5,6]  <- round(summary(m1.cu)$coef[1,1], 2)                             # intercept estimate
table.2[5,7]  <- round(summary(m1.cu)$coef[3,1], 2)                             # VI estimate
table.2[5,8]  <- round(summary(m1.cu)$coef[3,2], 2)                             # SE
table.2[5,9]  <- round(summary(m1.cu)$coef[3,3], 2)                             # df
table.2[5,10] <- round(summary(m1.cu)$coef[3,4], 2)                             # t.val
table.2[5,11] <- round(summary(m1.cu)$coef[3,5], 5)                             # p.val
# ----------------------------------------------------------------
table.2[6,6]  <- round(summary(m1.cu)$coef[1,1], 2)                             # intercept estimate
table.2[6,7]  <- round(summary(m1.cu)$coef[4,1], 2)                             # VI estimate
table.2[6,8]  <- round(summary(m1.cu)$coef[4,2], 2)                             # SE
table.2[6,9]  <- round(summary(m1.cu)$coef[4,3], 2)                             # df
table.2[6,10] <- round(summary(m1.cu)$coef[4,4], 2)                             # t.val
table.2[6,11] <- round(summary(m1.cu)$coef[4,5], 5)                             # p.val

View(table.2)
```

# CHANGE THE NAMES HERE --------------------------------------------------------
```{r}
table_n1.G1.poly <- table.2 %>% as.tibble
write.csv(table_n1.G1.poly, "table_n1.G1.poly.csv")
```

# remove the objects
```{r}
rm(group_name, group_num, problem_size, problem_type, m1, pre.m1, m1.e1, m1.e2, m1.e3, m1.e4, m1.e5, m1.e6, m1.e7, m1.sq, m1.cu, aov_table, table.1, table.2)
```

```{r}
# SPECIFY THE GROUP
group_num = 0.5                                                                 # -0.5 ~ grade 1; 0.5 ~ grade 6

# Grade 6 ----------------------------------------------------------------------
m1  <- lmer(log(RT) ~ sum.f.n + (1 + sum.f.n|subject) + (1|item), data = filter(d, group.cod == group_num), REML = FALSE)
summary(m1)
performance::check_model(m1)

# # processing speed -------------------------------------------------------------
# m1.ps  <- lmer((1000/RT) ~ sum.f.n + (1 + sum.f.n|subject) + (1|item), data = filter(d, group.cod == group_num), REML = FALSE)
# summary(m1.ps)
# performance::check_model(m1.ps)


# predictions ------------------------------------------------------------------

pre.m1 <- ggpredict(m1, terms = "sum.f.n", se = TRUE, back.transform = FALSE)
pre.m1
plot(pre.m1)

# sum.f.n | Predicted |       95% CI
# ----------------------------------
#   -1.52 |      7.00 | [6.89, 7.11]
#   -1.09 |      7.00 | [6.90, 7.10]
#   -0.65 |      7.01 | [6.91, 7.10]
#   -0.22 |      7.01 | [6.92, 7.10]
#    0.22 |      7.01 | [6.92, 7.11]
#    0.66 |      7.02 | [6.93, 7.11]
#    1.09 |      7.02 | [6.93, 7.12]
#    1.53 |      7.03 | [6.92, 7.13]
```

```{r}
## Control models:
# square -----------------------------------------------------------------------
# m1.sq <- lmer(log(RT) ~ sum.f.n + I(sum.f.n^2) + (1 + sum.f.n + I(sum.f.n^2)|subject) + (1|item), data = filter(d, group.cod == group_num), REML = FALSE)
# # failed to converge
# summary(m1.sq)

m1.sq <- lmer(log(RT) ~ sum.f.n + I(sum.f.n^2) + (1 + sum.f.n + I(sum.f.n^2)||subject) + (1|item), data = filter(d, group.cod == group_num), REML = FALSE)
summary(m1.sq)

# predictions ------------------------------------------------------------------
pre.m1.sq <- ggpredict(m1.sq, terms = "sum.f.n[all]", se = TRUE, back.transform = FALSE)
pre.m1.sq
plot(pre.m1.sq)

# sum.f.n | Predicted |       95% CI
# ----------------------------------
#   -1.52 |      6.94 | [6.83, 7.05]
#   -1.09 |      6.99 | [6.90, 7.09]
#   -0.65 |      7.03 | [6.94, 7.13]
#   -0.22 |      7.05 | [6.96, 7.15]
#    0.22 |      7.06 | [6.96, 7.15]
#    0.66 |      7.04 | [6.95, 7.14]
#    1.09 |      7.02 | [6.92, 7.11]
#    1.53 |      6.97 | [6.86, 7.08]

# cubic ------------------------------------------------------------------------
# m1.cu <- lmer(log(RT) ~ sum.f.n + I(sum.f.n^2) + I(sum.f.n^3) + (1 + sum.f.n + I(sum.f.n^2) + I(sum.f.n^3)|subject) + (1|item), data = filter(d, group.cod == group_num), REML = FALSE)
# # failed to converge
# summary(m1.cu)
# 
# m1.cu <- lmer(log(RT) ~ sum.f.n + I(sum.f.n^2) + I(sum.f.n^3) + (1 + sum.f.n + I(sum.f.n^2) + I(sum.f.n^3)||subject) + (1|item), data = filter(d, group.cod == group_num), REML = FALSE)
# # singular
# summary(m1.cu)

m1.cu <- lmer(log(RT) ~ sum.f.n + I(sum.f.n^2) + I(sum.f.n^3) + (1 + sum.f.n + I(sum.f.n^2)|subject) + (1|item), data = filter(d, group.cod == group_num), REML = FALSE)
# ok
summary(m1.cu)
```


```{r}
## Alternative predictors -----------------------------------------------------
# m1.e1 <- lmer(log(RT) ~ pre.min.n +            (1 + pre.min.n|subject) + (1|item),            data = filter(d, group.cod == group_num), REML = FALSE)
m1.e2 <- lmer(log(RT) ~ pre.max.n +            (1 + pre.max.n|subject) + (1|item),            data = filter(d, group.cod == group_num), REML = FALSE)
# m1.e3 <- lmer(log(RT) ~ pre.product.n +        (1 + pre.product.n|subject) + (1|item),        data = filter(d, group.cod == group_num), REML = FALSE)
m1.e4 <- lmer(log(RT) ~ pre.sum_squared.n +    (1 + pre.sum_squared.n|subject) + (1|item),    data = filter(d, group.cod == group_num), REML = FALSE)
m1.e5 <- lmer(log(RT) ~ pre.sup_op_squared.n + (1 + pre.sup_op_squared.n|subject) + (1|item), data = filter(d, group.cod == group_num), REML = FALSE)
m1.e6 <- lmer(log(RT) ~ op.1.n +               (1 + op.1.n|subject) +               (1|item), data = filter(d, group.cod == group_num), REML = FALSE)
m1.e7 <- lmer(log(RT) ~ op.2.n +               (1 + op.2.n|subject) +               (1|item), data = filter(d, group.cod == group_num), REML = FALSE) 


aov_table <- anova(m1, 
             # m1.e1, 
             m1.e2, 
             # m1.e3,
             m1.e4, 
             m1.e5,
             m1.e6,
             m1.e7
             )
```
# Change the names for each table ----------------------------------------------
```{r}
group_name = "grade 6"                                                          # grade 1 or grade 6
problem_type = "1-problems"                                                        # non-tie or tie
problem_size = "none"                                                     # very small, medium small, large, small
```

# TABLE 1: Models and control models -------------------------------------------
```{r}
table.1 <- matrix(NA, nrow = 6, ncol = 12)
colnames(table.1) <- c("age_group",
                        "problem_type",
                        "problem_size",
                        "VI",
                        "intercept estimate [log]",
                        "VI estimate [log]",
                        "SE",
                        "df",
                        "t.val",
                        "p.val",
                        "AIC",
                        "BIC")

table.1[,4] <- c("Sum", 
                 # "Min(op.1|op.2)", 
                 "Max(op.1|op.2)", 
                 # "product ~ (op.1*op.2)", 
                 "sum_sq ~ (op.1+op.2)^2", 
                 "sum_sq_op ~ op.1^2+op.2^2", 
                 "op.1", "op.2")

table.1[,1] <- group_name
table.1[,2] <- problem_type
table.1[,3] <- problem_size

View(table.1)

table.1[1,5] <- round(summary(m1)$coef[1,1], 2)
table.1[1,6] <- round(summary(m1)$coef[2,1], 2)
table.1[1,7] <- round(summary(m1)$coef[2,2], 2)
table.1[1,8] <- round(summary(m1)$coef[2,3], 2)
table.1[1,9] <- round(summary(m1)$coef[2,4], 2)
table.1[1,10]<- round(summary(m1)$coef[2,5], 5)
#------------------------------------------------------------------------------ Min
# table.1[2,5] <- round(summary(m1.e1)$coef[1,1], 2)
# table.1[2,6] <- round(summary(m1.e1)$coef[2,1], 2)
# table.1[2,7] <- round(summary(m1.e1)$coef[2,2], 2)
# table.1[2,8] <- round(summary(m1.e1)$coef[2,3], 2)
# table.1[2,9] <- round(summary(m1.e1)$coef[2,4], 2)
# table.1[2,10]<- round(summary(m1.e1)$coef[2,5], 5)
#-------------------------------.---------------------------------- Max
table.1[2,5] <- round(summary(m1.e2)$coef[1,1], 2)
table.1[2,6] <- round(summary(m1.e2)$coef[2,1], 2)
table.1[2,7] <- round(summary(m1.e2)$coef[2,2], 2)
table.1[2,8] <- round(summary(m1.e2)$coef[2,3], 2)
table.1[2,9] <- round(summary(m1.e2)$coef[2,4], 2)
table.1[2,10]<- round(summary(m1.e2)$coef[2,5], 5)
#-------------------------------.---------------------------------- product
# table.1[4,5] <- round(summary(m1.e3)$coef[1,1], 2)
# table.1[4,6] <- round(summary(m1.e3)$coef[2,1], 2)
# table.1[4,7] <- round(summary(m1.e3)$coef[2,2], 2)
# table.1[4,8] <- round(summary(m1.e3)$coef[2,3], 2)
# table.1[4,9] <- round(summary(m1.e3)$coef[2,4], 2)
# table.1[4,10]<- round(summary(m1.e3)$coef[2,5], 5)
#-------------------------------.---------------------------------- sum_sq
table.1[3,5] <- round(summary(m1.e4)$coef[1,1], 2)
table.1[3,6] <- round(summary(m1.e4)$coef[2,1], 2)
table.1[3,7] <- round(summary(m1.e4)$coef[2,2], 2)
table.1[3,8] <- round(summary(m1.e4)$coef[2,3], 2)
table.1[3,9] <- round(summary(m1.e4)$coef[2,4], 2)
table.1[3,10]<- round(summary(m1.e4)$coef[2,5], 5)
#-------------------------------.---------------------------------- sum_sq_op
table.1[4,5] <- round(summary(m1.e5)$coef[1,1], 2)
table.1[4,6] <- round(summary(m1.e5)$coef[2,1], 2)
table.1[4,7] <- round(summary(m1.e5)$coef[2,2], 2)
table.1[4,8] <- round(summary(m1.e5)$coef[2,3], 2)
table.1[4,9] <- round(summary(m1.e5)$coef[2,4], 2)
table.1[4,10]<- round(summary(m1.e5)$coef[2,5], 5)
#-------------------------------.---------------------------------- op.1
table.1[5,5] <- round(summary(m1.e6)$coef[1,1], 2)
table.1[5,6] <- round(summary(m1.e6)$coef[2,1], 2)
table.1[5,7] <- round(summary(m1.e6)$coef[2,2], 2)
table.1[5,8] <- round(summary(m1.e6)$coef[2,3], 2)
table.1[5,9] <- round(summary(m1.e6)$coef[2,4], 2)
table.1[5,10]<- round(summary(m1.e6)$coef[2,5], 5)
#-------------------------------.---------------------------------- op.2
table.1[6,5] <- round(summary(m1.e7)$coef[1,1], 2)
table.1[6,6] <- round(summary(m1.e7)$coef[2,1], 2)
table.1[6,7] <- round(summary(m1.e7)$coef[2,2], 2)
table.1[6,8] <- round(summary(m1.e7)$coef[2,3], 2)
table.1[6,9] <- round(summary(m1.e7)$coef[2,4], 2)
table.1[6,10]<- round(summary(m1.e7)$coef[2,5], 5)

table.1[,11]  <- round(aov_table[,2], 2)
table.1[,12]  <- round(aov_table[,3], 2)

View(table.1)
```

# CHANGE THE NAME HERE:
```{r}
table_n1.G6 <- table.1 %>% as.tibble()
write.csv(table_n1.G6, "table_n1.G6.csv")
```

# TABLE 2: higher order polynomials --------------------------------------------
```{r}
table.2 <- matrix(NA, nrow = 6, ncol = 12) 

colnames(table.2) <- c("age_group",
                        "problem_type",
                        "problem_size",
                        "model",
                        "VI",
                        "intercept estimate [log]",
                        "VI estimate [log]",
                        "SE",
                        "df",
                        "t.val",
                        "p.val",
                         "note")

table.2[,4] <- c("lineal", "cuadratic", "cuadratic", "cubic", "cubic", "cubic")
table.2[,5] <- c("Sum", "Sum", "Sum^2", "Sum", "Sum^2", "Sum^3")

table.2[,1] <- group_name
table.2[,2] <- problem_type
table.2[,3] <- problem_size

View(table.2)

# linear
table.2[1,6]  <- round(summary(m1)$coef[1,1], 2)                                # intercept estimate
table.2[1,7]  <- round(summary(m1)$coef[2,1], 2)                                # VI estimate
table.2[1,8]  <- round(summary(m1)$coef[2,2], 2)                                # SE
table.2[1,9]  <- round(summary(m1)$coef[2,3], 2)                                # df
table.2[1,10] <- round(summary(m1)$coef[2,4], 2)                                # t.val
table.2[1,11] <- round(summary(m1)$coef[2,5], 5)                                # p.val
# cuadratic --------------------------------------------------------
table.2[2,6]  <- round(summary(m1.sq)$coef[1,1], 2)                             # intercept estimate
table.2[2,7]  <- round(summary(m1.sq)$coef[2,1], 2)                             # VI estimate
table.2[2,8]  <- round(summary(m1.sq)$coef[2,2], 2)                             # SE
table.2[2,9]  <- round(summary(m1.sq)$coef[2,3], 2)                             # df
table.2[2,10] <- round(summary(m1.sq)$coef[2,4], 2)                             # t.val
table.2[2,11] <- round(summary(m1.sq)$coef[2,5], 5)                             # p.val
# ----------------------------------------------------------------
table.2[3,6]  <- round(summary(m1.sq)$coef[1,1], 2)                             # intercept estimate
table.2[3,7]  <- round(summary(m1.sq)$coef[3,1], 2)                             # VI estimate
table.2[3,8]  <- round(summary(m1.sq)$coef[3,2], 2)                             # SE
table.2[3,9]  <- round(summary(m1.sq)$coef[3,3], 2)                             # df
table.2[3,10] <- round(summary(m1.sq)$coef[3,4], 2)                             # t.val
table.2[3,11] <- round(summary(m1.sq)$coef[3,5], 5)                             # p.val
# cubic ---------------------------------------------------------
table.2[4,6]  <- round(summary(m1.cu)$coef[1,1], 2)                             # intercept estimate
table.2[4,7]  <- round(summary(m1.cu)$coef[2,1], 2)                             # VI estimate
table.2[4,8]  <- round(summary(m1.cu)$coef[2,2], 2)                             # SE
table.2[4,9]  <- round(summary(m1.cu)$coef[2,3], 2)                             # df
table.2[4,10] <- round(summary(m1.cu)$coef[2,4], 2)                             # t.val
table.2[4,11] <- round(summary(m1.cu)$coef[2,5], 5)                             # p.val
# ----------------------------------------------------------------
table.2[5,6]  <- round(summary(m1.cu)$coef[1,1], 2)                             # intercept estimate
table.2[5,7]  <- round(summary(m1.cu)$coef[3,1], 2)                             # VI estimate
table.2[5,8]  <- round(summary(m1.cu)$coef[3,2], 2)                             # SE
table.2[5,9]  <- round(summary(m1.cu)$coef[3,3], 2)                             # df
table.2[5,10] <- round(summary(m1.cu)$coef[3,4], 2)                             # t.val
table.2[5,11] <- round(summary(m1.cu)$coef[3,5], 5)                             # p.val
# ----------------------------------------------------------------
table.2[6,6]  <- round(summary(m1.cu)$coef[1,1], 2)                             # intercept estimate
table.2[6,7]  <- round(summary(m1.cu)$coef[4,1], 2)                             # VI estimate
table.2[6,8]  <- round(summary(m1.cu)$coef[4,2], 2)                             # SE
table.2[6,9]  <- round(summary(m1.cu)$coef[4,3], 2)                             # df
table.2[6,10] <- round(summary(m1.cu)$coef[4,4], 2)                             # t.val
table.2[6,11] <- round(summary(m1.cu)$coef[4,5], 5)                             # p.val

View(table.2)
```

# CHANGE THE NAMES HERE --------------------------------------------------------
```{r}
table_n1.G6.poly <- table.2 %>% as.tibble
write.csv(table_n1.G6.poly, "table_n1.G6.poly.csv")
```

# remove the objects
```{r}
rm(group_name, group_num, problem_size, problem_type, m1, pre.m1, m1.e1, m1.e2, m1.e3, m1.e4, m1.e5, m1.e6, m1.e7, m1.sq, m1.cu, aov_table, table.1, table.2)
```